---
title: "Install LaTeX for PDF"
output: 
  html_document:  
    code_folding: show
    number_section: no
---

<!-- Include shared Links -->
```{r rmd_pdf, child="../shared/links.Rmd"}
```

```{r setup, include=FALSE}
# 共通chunkオプションの指定
knitr::opts_chunk$set(warning = FALSE, echo = TRUE)

# データハンドリングで利用するパッケージの読み込み
require(tidyverse)
```

R MarkdownはPDFファイルの作成も可能です。ただし、PDFの作成には外部プログラムとして$\TeX/\LaTeX$環境が必要となります。RStudioが推奨する$\TeX/\LaTeX$は以下の通りです。  
　  

OS      | 推奨$\TeX/\LaTeX$ | 日本語対応
--------|-------------------|------------
Linux   | TeX Live 2013以降 | 対応
MacOS   | MacTex 2013以降   | 対応
Windows | MiKTeX            | 非対応

　  
日本語Windows環境ではMiKTeXはあまり推奨できませんので、Linux環境と同様にTeX Liveが無難です。ただし、TeX Liveは$\TeX/\LaTeX$の集大成ともいえる巨大なパッケージの集合で、数千ものパッケージの中から必要なパッケージのみをインストールには$\TeX/\LaTeX$に精通している必要があります。ですから通常は"scheme-full"というフルパッケージをインストールしますが、フルパッケージは4GB超のサイズがあり通信環境やPC性能によっては一晩かかってもインストールできない場合があります。そこで、おすゝめするなのが[TinyTeX][TT]です。  
　  

# TinyTeXとは
[TinyTeX][TT]は[RStudio社](https://www.rstudio.com/)で[R Markdown][RMD]などの開発を担当しているYihui Xie氏によるTeX Liveをベースとした軽量ディストリビューションです。実際、日本語関連のパッケージを入れても300MB程度と非常にコンパクトです。  
同名の[**`tinytex`**][tinytex]パッケージを用いることで[R][R]からインストールやメンテナンスができるようになります。特に$\TeX/\LaTeX$を利用するのは[R Markdown][RMD]だけという場合には最適です。  
　  

# インストール
[TinyTeX][TT]をインストールするには前述のように[**`tinytex`**][tinytex]パッケージが必要です。  

Package | Description
--------|-------------
tinytex | Helper Functions to Install and Maintain 'TeX Live'

　  
インストール手順は以下のようになります。  

1. **`tinytex`**パッケージのインストール
1. TinyTeXのインストール
1. RStudioの再起動（**`tinytex`**パッケージの仕様上必要）
1. IPAフォントのインストール（必要に応じて）
1. テストビルド（動作確認）

　  

## **`tinytex`**パッケージのインストール
[R][R]のターミナルから以下のコマンド（関数）を実行するか、RStudioのパッケージマネージャから**`tinytex`**パッケージをインストールします。  
　  

```{r, eval=FALSE}
install.packages("tinytex")
```

　  

## TinyTeXのインストール
**`tinytex`**パッケージがインストールされたら、[R][R]のターミナルから以下のコマンド（関数）を実行します。  
　  

```{r, eval=FALSE}
tinytex::install_tinytex()
```

　  

途中で以下のようなメッセージが表示されます。文字通り[TinyTeX][TT]をインストール中にワーニングメッセージが表示されるのですが、これらが表示されもて[TinyTeX][TT]のインストールには影響はありませんので気にしないで下さい。  
　  

![](./fig/tinytex_error.png)

　  
その後、延々とメッセージが表示され途中止まったようになりますが気長に待ってください。回線にもよりますが10分程度でインストールは終わります。  
　  

## RStudioの再起動
[TinyTeX][TT]のインストールが完了したら[RStudio][RSD]を再起動してください。これは現在の**`tinytex`**パッケージ(v0.4)での制限事項のようです。  
　  

## IPAフォントのインストール
[TinyTeX][TT]で日本語を扱う場合、標準でIPAフォントとIPAexフォントが使用されます。これらのフォントがインストールされていませんとkint中でエラーが発生してPDFファイルが作成できませんのでインストールされていな場合は[こちら](https://ipafont.ipa.go.jp/)からダウンロードして必ずインストールしておいてください。  
　  

## テストビルド
[RStudio][RSD]を再起動したら利用する$\LaTeX$エンジンに応じたYAMLを記述した日本語を含む[R Mardkown][RMD]ファイルを用意してknitしてみて下さい。特に問題なくPDFファイルがビルドされるハズです。  
パッケージが不足している場合はknit中に自動的にインストールしてくれます。  
　  

![](./fig/tinytex_knit.png)

　  

### **`xelatex`**を使う場合
```
---
output: 
  pdf_document:
    latex_engine: xelatex
    pandoc_args: --top-level-division=chapter
documentclass: bxjsbook
classoption: xelatex, ja=standard
geometry: no
---
```

　  

### **`lualatex`**を使う場合
```
---
output: 
  pdf_document: 
    latex_engine: lualatex 
    pandoc_args: --top-level-division=chapter
documentclass: ltjsarticle 
---
```

　  

---

<!-- Include Footer -->
```{r child="../shared/footer.Rmd"}
```

[TT]: https://yihui.name/tinytex/ "A lightweight, cross-platform, portable, and easy-to-maintain LaTeX distribution based on TeX Live"
[tinytex]: https://cran.r-project.org/web/packages/tinytex/index.html "tinytex package"