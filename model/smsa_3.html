<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>第3章 例題・演習解答例</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/htmlwidgets-1.0/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.4/datatables.js"></script>
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="site_libs/dt-ext-scroller-1.10.16/css/scroller.dataTables.min.css" rel="stylesheet" />
<script src="site_libs/dt-ext-scroller-1.10.16/js/dataTables.scroller.min.js"></script>
<link href="site_libs/dt-ext-fixedcolumns-1.10.16/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="site_libs/dt-ext-fixedcolumns-1.10.16/js/dataTables.fixedColumns.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Model/Infer</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    基礎知識
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="norm.html">正規性の確認</a>
    </li>
    <li class="dropdown-header">等分散性の確認</li>
    <li>
      <a href="t_test.html">平均値の差の検定</a>
    </li>
    <li class="dropdown-header">ソルバー</li>
    <li class="dropdown-header">分散分析</li>
    <li class="dropdown-header">回帰分析</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    書籍
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">データ指向のソフトウェア品質マネジメント</li>
    <li class="divider"></li>
    <li class="dropdown-header">ソフトウェアメトリクス統計分析入門</li>
    <li>
      <a href="./smsa_1.html">　第１章 例題・演習回答例</a>
    </li>
    <li>
      <a href="./smsa_2.html">　第２章 例題・演習回答例</a>
    </li>
    <li>
      <a href="./smsa_3.html">　第３章 例題・演習回答例</a>
    </li>
    <li>
      <a href="./smsa_4.html">　第４章 例題・演習回答例</a>
    </li>
    <li>
      <a href="./smsa_5.html">　第５章 例題・演習回答例</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">統計学基礎</li>
    <li class="dropdown-header">　第１章 演習回答例</li>
    <li class="dropdown-header">　第１章 演習回答例</li>
    <li class="dropdown-header">　第２章 演習回答例</li>
    <li class="dropdown-header">　第３章 演習回答例</li>
    <li class="dropdown-header">　第４章 演習回答例</li>
    <li class="dropdown-header">　第５章 演習回答例</li>
    <li class="dropdown-header">　第６章 演習回答例</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-graduation-cap"></span>
     
    gacco
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">社会人のためのデータサイエンス入門</li>
    <li class="dropdown-header">社会人のためのデータサイエンス演習</li>
    <li class="dropdown-header">誰でも使える統計オープンデータ</li>
    <li class="divider"></li>
    <li class="dropdown-header">統計学I</li>
    <li class="dropdown-header">統計学II</li>
    <li class="dropdown-header">統計学III</li>
  </ul>
</li>
<li>
  <a href="./about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-github"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../index.html">Cabinet</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../import/index.html">Import</a>
    </li>
    <li>
      <a href="../tidy/index.html">Tidy/Transform</a>
    </li>
    <li>
      <a href="./index.html">
        <span class="fa fa-home"></span>
         
        Model/Infer
      </a>
    </li>
    <li>
      <a href="../visualize/index.html">Visualize</a>
    </li>
    <li>
      <a href="../communicate/index.html">Communicate/Automate</a>
    </li>
    <li>
      <a href="../program/index.html">Program</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://github.com/k-metrics/cabinet">
        <span class="fa fa-github"></span>
         
        GitHub Repository
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://sites.google.com/site/kantometrics/home">
        <span class="fa fa-google"></span>
         
        データ分析勉強会
      </a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">第3章 例題・演習解答例</h1>

</div>


<!-- Include shared Links -->
<!-- SQiP and others -->
<!-- Books -->
<!-- 共立出版 -->
<!-- 日科技連出版 -->
<!-- O'Reilly Japan -->
<!-- 東京図書 -->
<!-- Docker -->
<!-- eBooks -->
<!-- Net Community -->
<!-- Style Guide -->
<!-- Creative Commons -->
<!-- Others -->
<!-- R -->
<!-- R Packages -->
<!-- RStudio -->
<!-- Docker -->
<!-- Cabinet Pages -->
<p>本資料は『<a href="http://www.juse-p.co.jp/cgi-bin/html.pl5?i=ISBN978-4-8171-9558-6" target="_blank" title="ソフトウェアメトリクス統計分析入門">ソフトウェアメトリクス統計分析入門 <i class="fa fa-external-link"></i></a>』(以降、テキストと記載)の第3章の例題を<a href="https://www.r-project.org/" target="_blank" title="The R Project">R <i class="fa fa-external-link"></i></a>で解いた際の解答例を示したものです。また、<a href="http://rmarkdown.rstudio.com/" target="_blank" title="R Markdown from RStudio Inc">R Markdown <i class="fa fa-external-link"></i></a>を使うメリットを示すための一手段として作成していますので、テキストにおける計算方法とは異なる部分もあります。本資料で使用しているデータの入手に関してはテキストにてご確認下さい。<br />
本資料がHTML形式の場合、<a href="https://www.r-project.org/" target="_blank" title="The R Project">R <i class="fa fa-external-link"></i></a>のコードを参照するには右側にある<strong><code>[Code]</code></strong>ボタンをクリックして下さい。なお、JavaScriptは必ずOnにしてご覧下さい。<br />
　</p>
<div id="例題-3.1" class="section level1">
<h1>例題 3.1</h1>
<blockquote>
<p>表3.4にレビュー指摘による欠陥密度データが11 個あります。 データをそれぞれ適用したレビュー技法ごとに分類しています。 レビュー対象の品質を考慮して技法を使い分けすることは特にしていない前提とします。 レビュー技法の違いは、欠陥密度に対して影響を与えているといえるでしょうか。 　</p>
</blockquote>
<div id="データの設定" class="section level2">
<h2>データの設定</h2>
<p>本例題で利用するデータは予めCSVファイルとして保存されているものとします。表3.4で示めされているようにデータはワイドフォーマット（アンスタック形式）で「対応なし・各群の標本数が異なる」データとなっています。Rで処理するためには基本的にロングフォーマット（スタック形式）に変換する必要がありますので、予めロングフォーマットに変換しておくか、読み込んでからロングフォーマットに変換します。</p>
<p>　</p>
<div id="フォーマット変換" class="section level3">
<h3>フォーマット変換</h3>
<p>データはすぐに分析できる形で保存されていることは稀です。これは、データ分析に慣れていない人が整理していたり、説明がしやすい形に整理されていることに起因します。しかし、これらのデータを手動で変換していると変換間違いが混入する可能性が高いので、できる限り自動化して間違いを防ぎたいものです。また、データ量が多い場合には工数削減に直結するので変換処理の自動化は覚えておいて損はありません。</p>
<p>Rにおいてフォーマット変換を行う方法はいくつかありますが、ここでは<strong><code>tidyr</code></strong>パッケージを用いた方法を紹介します。なお、<strong><code>tidyr</code></strong>パッケージは<strong><code>dplyr</code></strong>パッケージと共に使うことを前提に設計されています。<br />
　</p>
<div id="データの準備" class="section level4">
<h4>データの準備</h4>
<p>今回用いる表3.4は、見出し行を除いたデータだけのCSV形式として保存しておきます</p>
<table>
<thead>
<tr class="header">
<th>RM</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>2.2</td>
<td>3.4</td>
<td>2.8</td>
<td>1.2</td>
</tr>
<tr class="even">
<td>I</td>
<td>3.0</td>
<td>4.4</td>
<td>5.8</td>
<td></td>
</tr>
<tr class="odd">
<td>W</td>
<td>4.6</td>
<td>4.2</td>
<td>4.0</td>
<td>4.8</td>
</tr>
</tbody>
</table>
<ul>
<li>上表は便宜上、列名（ヘッダ）を記載してありますが、今回は列名（ヘッダ）のないデータ形式としておきます</li>
<li>列名（ヘッダ）があっても基本的な処理は同じです</li>
</ul>
<p>　</p>
</div>
<div id="データの読み込みと変換" class="section level4">
<h4>データの読み込みと変換</h4>
<p>次に以下の手順でファイルを読み込み変換処理を行います。</p>
<ol style="list-style-type: decimal">
<li>1列目のレビュー技法（分類）は行名として読み込みます（列名は自動付与）</li>
<li>読み込んだデータフレームを転置します（行名が列名になります）</li>
<li>データフレーム型に変換します（転置後はマトリクス型になるため）</li>
<li>ロングフォーマットに変換します</li>
<li>分類の列を因子型に変換します（転置後は文字列型になるため）</li>
<li>使用しないNAデータを削除します</li>
</ol>
<p>　<br />
実際の処理手順は下記の<code>Code</code>ボタンをクリックしてコードを展開して確認してください。なお、データ数が多い場合はデータフレーム型と互換性のあるテーブル・ データフレーム型（<code>tbl_df</code>）に変換しておくと何かと便利です。</p>
<p>ロングフォーマットに変換したデータは以下のようになります。</p>
<pre class="r"><code># HTML出力またはコンソール出力の場合はインタラクティブなテーブル表示とする
x %&gt;% 
  dplyr::rename(&#39;レビュー技法&#39; = review.method, &#39;指摘密度&#39; = defect.density)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["レビュー技法"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["指摘密度"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"2.2","_rn_":"1"},{"1":"A","2":"3.4","_rn_":"2"},{"1":"A","2":"2.8","_rn_":"3"},{"1":"A","2":"1.2","_rn_":"4"},{"1":"W","2":"3.0","_rn_":"5"},{"1":"W","2":"4.4","_rn_":"6"},{"1":"W","2":"5.8","_rn_":"7"},{"1":"I","2":"4.6","_rn_":"9"},{"1":"I","2":"4.2","_rn_":"10"},{"1":"I","2":"4.0","_rn_":"11"},{"1":"I","2":"4.8","_rn_":"12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>x %&gt;% 
  dplyr::group_by(review.method) %&gt;% 
  dplyr::summarise(n = n()) %&gt;% 
  dplyr::rename(&#39;レビュー技法&#39; = review.method, &#39;データ数&#39; = n)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["レビュー技法"],"name":[1],"type":["fctr"],"align":["left"]},{"label":["データ数"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"A","2":"4"},{"1":"I","2":"4"},{"1":"W","2":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="逆フォーマット変換" class="section level3">
<h3>逆フォーマット変換</h3>
<p>ロングフォーマットをワイドフォーマットに再変換したい場合は、再変換時に行識別ができるように以下のような行識別情報を持ったデータフレームを保持しておきます。</p>
<pre class="r"><code>file &lt;- &quot;./data/ex_3.1_w.csv&quot;   # ワイドフォーマットで読み込む

x.l &lt;- read.csv(file, header = FALSE, sep = &quot;,&quot;, row.names = 1,
                fileEncoding = &quot;CP932&quot;) %&gt;%
  t() %&gt;%         # 転置行列の作成
  dplyr::tbl_df() %&gt;%    # データフレーム型への変更 as.data.frame() %&gt;%
  dplyr::mutate(id = row_number()) %&gt;% 
                  # 行識別情報を付加する
  tidyr::gather(key = review.method, value = defect.density, -id) %&gt;%
                  # ロングフォーマットへの変換
  dplyr::mutate(review.method = as.factor(review.method)) 
                  # 因子型への変換

# HTML出力またはコンソール出力の場合はインタラクティブなテーブル表示とする
x.l</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["int"],"align":["right"]},{"label":["review.method"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["defect.density"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"A","3":"2.2"},{"1":"2","2":"A","3":"3.4"},{"1":"3","2":"A","3":"2.8"},{"1":"4","2":"A","3":"1.2"},{"1":"1","2":"W","3":"3.0"},{"1":"2","2":"W","3":"4.4"},{"1":"3","2":"W","3":"5.8"},{"1":"4","2":"W","3":"NA"},{"1":"1","2":"I","3":"4.6"},{"1":"2","2":"I","3":"4.2"},{"1":"3","2":"I","3":"4.0"},{"1":"4","2":"I","3":"4.8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>x.w &lt;- x.l %&gt;% 
  tidyr::spread(key = review.method, value = defect.density) %&gt;% 
  dplyr::select(-id)

x.w</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["A"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["I"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["W"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.2","2":"4.6","3":"3.0"},{"1":"3.4","2":"4.2","3":"4.4"},{"1":"2.8","2":"4.0","3":"5.8"},{"1":"1.2","2":"4.8","3":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>t(x.w) %&gt;% as.data.frame()</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["V1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["V2"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["V3"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["V4"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.2","2":"3.4","3":"2.8","4":"1.2","_rn_":"A"},{"1":"4.6","2":"4.2","3":"4.0","4":"4.8","_rn_":"I"},{"1":"3.0","2":"4.4","3":"5.8","4":"NA","_rn_":"W"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="データ分布の確認" class="section level2">
<h2>データ分布の確認</h2>
<p>技法の違いが欠陥密度に与える影響を見るには分散分析<code>aov{stats}</code>を用いるのが適当であると考えられますが、分散分析は母集団の分布を以下のように仮定しています。</p>
<ul>
<li>正規分布にしたがう</li>
<li>等分散である</li>
</ul>
<p>今回は各群（水準）のデータ数が3～4個と少ないため、正規性についてはデータ数が増えれば正規分布になるという仮定の元、検定を省略します。等分散性については等分散が認められなければWelch検定を用いることにします。</p>
<div id="等分散性の検定" class="section level3">
<h3>等分散性の検定</h3>
<p>今回は各群（水準）のデータ数が3～4個と少ないですが念のために等分散性の検定を行います。各群（水準）のデータ数は前述のように異なり、また、各値の対応はありませんので、3水準以上に対応できるバートレットの検定<code>bartlett.test{stats}</code>にて等分散性を確認します。</p>
<pre class="r"><code>bartlett.test(defect.density ~ review.method, data = x)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  defect.density by review.method
## Bartlett&#39;s K-squared = 3.3812, df = 2, p-value = 0.1844</code></pre>
</div>
</div>
<div id="一元配置分散分析" class="section level2">
<h2>一元配置分散分析</h2>
<p>帰無仮説は棄却されませんでしたので、対象のデータは等分散性がないとは言えないため一元配置分散分析<code>aov{stats}</code>を用いて各群（水準）間の平均値の有意差の有無を確認します。</p>
<pre class="r"><code>result.aov &lt;- aov(defect.density ~ review.method, data = x)
summary(result.aov)</code></pre>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)  
## review.method  2  10.18   5.091   5.852 0.0272 *
## Residuals      8   6.96   0.870                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="多重比較" class="section level2">
<h2>多重比較</h2>
<p>一元配置分散分析の結果、<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されましたので、どの各群（水準）間に有意差があるかを多重比較により確認します。対象は前述の通り対応がなく各群（水準）のデータ数が異なりますので、多重比較としていくつかの検定方法がありますが、ここでは、Rcmdrで使われているテューキー・クレーマー法による多重比較を行います。</p>
<pre class="r"><code># Rcmdr
result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(review.method = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = defect.density ~ review.method, data = x)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)  
## I - A == 0   2.0000     0.6595   3.032   0.0386 *
## W - A == 0   2.0000     0.7124   2.807   0.0539 .
## W - I == 0   0.0000     0.7124   0.000   1.0000  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code># TukeyHSD
result.tukey &lt;- TukeyHSD(result.aov)
result.tukey</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = defect.density ~ review.method, data = x)
## 
## $review.method
##     diff         lwr      upr     p adj
## I-A    2  0.11538605 3.884614 0.0386871
## W-A    2 -0.03561572 4.035616 0.0538138
## W-I    0 -2.03561572 2.035616 1.0000000</code></pre>
<p>多重比較の結果、I(インスペクション)とA(アドホック)において有意差が認められます。</p>
</div>
<div id="結果の可視化" class="section level2">
<h2>結果の可視化</h2>
<p>因子間の平均の差の95%信頼区間は以下の通りとなります。</p>
<pre class="r"><code># Rcmdrにおける多重比較を行った場合
x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(review.method = as.factor(row.names(.))) %&gt;% 
  select(factor = review.method, lo = lwr, mu = Estimate, up = upr)

# TukeyHSDを使用した場合
# x.result &lt;- as.data.frame(result.tukey$review.method) %&gt;% 
#   mutate(review.method = as.factor(row.names(.))) %&gt;% 
#   select(factor = review.method, lo = lwr, mu = diff, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_hline(yintercept = 0, linetype = &quot;dashed&quot;, colour = &quot;red&quot;) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  geom_point(size = 3) +
  xlab(&quot;レビュー技法&quot;) + ylab(&quot;レビュー密度の平均値の差&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="各群の平均値の95信頼区間" class="section level2">
<h2>各群の平均値の95%信頼区間</h2>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(review.method) %&gt;%
  summarize(lo = round(t.test(defect.density)$conf.int[1], n),
            mu = round(t.test(defect.density)$estimate, n),
            up = round(t.test(defect.density)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = review.method, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;レビュー技法&quot;) + ylab(&quot;レビュー密度&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="例題-3.2" class="section level1">
<h1>例題 3.2</h1>
<blockquote>
<p>システム構成の違いがシステムのパフォーマンスにどの程度の影響を与えるのかを調べるために以下のようなデータを収集し、一元配置分散分析を行いました。 システム構成の違いがパフォーマンスに与える影響力は誤差範囲ではないといえるでしょうか。</p>
</blockquote>
<div id="データの設定-1" class="section level2">
<h2>データの設定</h2>
<p>本例題で利用するデータは予めCSVファイルとして保存されているものとします。なお、例題3.1で示したように例題3.2でもフォーマット変換により分析対象となるデータフレームを作成しています。</p>
<pre class="r"><code># 例題のデータを変形せずに読み込み、分析用データフレームに変換する
file &lt;- &quot;./data/ex_3.2.csv&quot;
x &lt;- read.csv(file, header = FALSE, row.names = 1, sep = &quot;,&quot;,
              fileEncoding = &quot;CP932&quot;) %&gt;%
  # システム構成の列を行名に設定して転置するのがポイント
  t() %&gt;%
  as.data.frame() %&gt;%
  tidyr::gather(key = sys.config, value = r.time) %&gt;% 
  mutate(sys.config = as.factor(sys.config))
  # mcp{multcomp}では因子型である必要があるため文字列型から変換

df_print(x)</code></pre>
<div id="htmlwidget-416ae2ef8d3ef7224e11" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-416ae2ef8d3ef7224e11">{"x":{"filter":"none","extensions":["Scroller","FixedColumns"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12"],["A","A","A","B","B","B","C","C","C","D","D","D"],[200,220,210,240,280,260,220,240,260,200,170,200]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sys.config<\/th>\n      <th>r.time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"deferRender":true,"dom":"t","scroller":false,"scrollY":250,"fixedColumns":true,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="データ分布の確認-1" class="section level2">
<h2>データ分布の確認</h2>
<p>例題3.1と同じで分散分析<code>aov{stats}</code>を用いるのが適当だと考えますが、念のためにデータ分布の確認を行います。正規性の検定については例題3.1と同じ理由から省略します。</p>
<div id="等分散性の確認" class="section level3">
<h3>等分散性の確認</h3>
<pre class="r"><code>bartlett.test(r.time ~ sys.config, data = x)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  r.time by sys.config
## Bartlett&#39;s K-squared = 0.86607, df = 3, p-value = 0.8336</code></pre>
</div>
</div>
<div id="一元配置分散分析-1" class="section level2">
<h2>一元配置分散分析</h2>
<p>帰無仮説は棄却されませんでしたので、対象データは等分散性がないとはいえないために一元配置分散分析<code>aov{stats}</code>を用いて各群（水準）間の平均値の有意差の有無を確認します。</p>
<pre class="r"><code>result.aov &lt;- aov(r.time ~ sys.config, data = x)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## sys.config   3   8700    2900   9.667 0.00489 **
## Residuals    8   2400     300                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="多重比較-1" class="section level2">
<h2>多重比較</h2>
<p>一元配置分散分析の結果、<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されましたので、多重比較により各群（水準）間に有意差があるのかを確認します。ここでもRcmdrで使われているティキュー・クレーマー法を用います。</p>
<pre class="r"><code># Rcmdr
result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(sys.config = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = r.time ~ sys.config, data = x)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)   
## B - A == 0    50.00      14.14   3.536  0.03138 * 
## C - A == 0    30.00      14.14   2.121  0.22514   
## D - A == 0   -20.00      14.14  -1.414  0.52529   
## C - B == 0   -20.00      14.14  -1.414  0.52524   
## D - B == 0   -70.00      14.14  -4.950  0.00491 **
## D - C == 0   -50.00      14.14  -3.536  0.03144 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code># TukeyHSD
result.tukey &lt;- TukeyHSD(result.aov)
result.tukey</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = r.time ~ sys.config, data = x)
## 
## $sys.config
##     diff         lwr        upr     p adj
## B-A   50    4.711904  95.288096 0.0313874
## C-A   30  -15.288096  75.288096 0.2252476
## D-A  -20  -65.288096  25.288096 0.5252407
## C-B  -20  -65.288096  25.288096 0.5252407
## D-B  -70 -115.288096 -24.711904 0.0049175
## D-C  -50  -95.288096  -4.711904 0.0313874</code></pre>
<p>多重比較の結果、システム構成A-B間、システム構成B-D間、システム構成C-D間に有意差が認められます。</p>
</div>
<div id="結果の可視化-1" class="section level2">
<h2>結果の可視化</h2>
<p>因子間の平均の差の95%信頼区間は以下の通りとなります。</p>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(sys.config = as.factor(row.names(.))) %&gt;% 
  select(factor = sys.config, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_hline(yintercept = 0, linetype = &quot;dashed&quot;, colour = &quot;red&quot;) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  geom_point(size = 3) +
  xlab(&quot;システム構成&quot;) + ylab(&quot;レスポンスタイムの平均値の差[msec]&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>この結果から</p>
<ul>
<li>システム構成Aはシステム構成B,Cに比べてレスポンスタイムの平均値が低い</li>
<li>システム構成Aはシステム構成Dに比べてレスポンスタイムの平均値が高い</li>
<li>システム構成Dはシステム構成A,B,Cに比べてレスポンスタイムの平均値が低い</li>
</ul>
<p>となります。単純にレスポンスタイムの平均値だけで決めるのであればシステム構成Dを選択すればよいことになります。しかし、システム構成AとDの平均値の差の95%信頼区間を確認すると必ずもシステム構成Dのレスポンスタイムが短いとは言い切れません。</p>
</div>
<div id="各群の平均値の95信頼区間-1" class="section level2">
<h2>各群の平均値の95%信頼区間</h2>
<p>そこで、各システム構成の平均値の95%信頼区間を確認してみます。</p>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(sys.config) %&gt;%
  summarize(lo = round(t.test(r.time)$conf.int[1], n),
            mu = round(t.test(r.time)$estimate, n),
            up = round(t.test(r.time)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = sys.config, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;システム構成&quot;) + ylab(&quot;レスポンスタイムの平均値[msec]&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>平均値でみるとシステム構成Dの方がレスポンスタイムが短いですが、95%信頼区間を見るとシステム構成Aの方が狭くレスポンスタイムにばらつきがありません。これより</p>
<ul>
<li>安定したレスポンスタイムが求められる場合はシステム構成A</li>
<li>全体として短いレスポンスタイムが求められる場合はシステム構成D</li>
</ul>
<p>という選択ができると考えます。<br />
　</p>
</div>
</div>
<div id="演習-3.1" class="section level1">
<h1>演習 3.1</h1>
<blockquote>
<p>完了したプロジェクトを上流でのレビュー実施度合いが、多い、中ぐらい、少ない、の3 段階に分類しました． そして、それらのプロジェクトの最終システムテスト工程での欠陥密度のデータは以下のとおりです。 上流でしっかりとレビューを実施すれば、システムテストでの欠陥密度は低下することが期待できます。 果たして、その期待どおり上流でのレビューは、下流での品質向上に効果があるといえるでしょうか。</p>
</blockquote>
<div id="データの設定-2" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="可視化" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = review.freq, y = defect.density)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) + 
  xlab(&quot;レビューの実施度合い&quot;) + ylab(&quot;欠陥密度&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="一元配置分散分析-2" class="section level2">
<h2>一元配置分散分析</h2>
<p>読み込んだデータは上記のように1変数と因子のですので、そのまま分析を行います。</p>
<pre class="r"><code>result.aov &lt;- aov(defect.density ~ review.freq, data = x)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## review.freq  2  1.093  0.5467   4.217  0.051 .
## Residuals    9  1.167  0.1296                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="多重比較-2" class="section level2">
<h2>多重比較</h2>
<p>一元配置分散分析の結果、<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されませんでしたが、多重比較により因子間に差を確認してみます。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(review.freq = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = defect.density ~ review.freq, data = x)
## 
## Linear Hypotheses:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## 多 - 少 == 0  -0.7000     0.2415  -2.898   0.0421 *
## 中 - 少 == 0  -0.4333     0.2750  -1.576   0.3034  
## 中 - 多 == 0   0.2667     0.2629   1.014   0.5862  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>多重比較の結果、一元配置分散分析では有意差は認められなかったもののレビュー頻度’多-小’において有意差が認められます。</p>
</div>
<div id="結果の可視化-2" class="section level2">
<h2>結果の可視化</h2>
<p>因子間の平均の差の95%信頼区間は以下の通りとなります。</p>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(review.freq = as.factor(row.names(.))) %&gt;% 
  select(factor = review.freq, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;レビュー頻度&quot;) + ylab(&quot;レビュー密度の平均値の差&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="結果の解釈" class="section level2">
<h2>結果の解釈</h2>
<p>一元配置分散分析において有意差は認められなかったものの多重比較を行うと有意差が認めれられています。これは、以下のような解釈(定性分析)により有意差は認められないと結論できのではないでしょうか？</p>
<div id="定性分析" class="section level3">
<h3>定性分析</h3>
</div>
</div>
<div id="参考因子毎の平均値の95信頼区間" class="section level2">
<h2>参考)因子毎の平均値の95%信頼区間</h2>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(review.freq) %&gt;%
  summarize(lo = round(t.test(defect.density)$conf.int[1], n),
            mu = round(t.test(defect.density)$estimate, n),
            up = round(t.test(defect.density)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = review.freq, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;レビューの実施度合い&quot;) + ylab(&quot;レビュー密度&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
</div>
<div id="演習-3.2" class="section level1">
<h1>演習 3.2</h1>
<blockquote>
<p>システムの機能を改良することになりました。GUI プロトタイプの変更案をA、B、C の3 つ作成しました。 現行も加えて4 つのGUI にて5 段階でユーザビリティ評価を行った結果が以下です。 GUI デザインの違いがユーザビリティに影響を与えているといえるでしょうか？また、どのGUI デザインを採用すべきでしょうか？</p>
</blockquote>
<div id="データの設定-3" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
<pre class="r"><code># 演習のデータを変形せずに読み込み、分析用データフレームに変換する
file &lt;- &quot;./data/ex3_2.csv&quot;
x &lt;- read.csv(file, header = FALSE, row.names = 1, sep = &quot;,&quot;,
              fileEncoding = &quot;CP932&quot;) %&gt;%
  # システム構成の列を行名に設定して転置するのがポイント
  t() %&gt;%
  as.data.frame() %&gt;%
  tidyr::gather(key = model, value = eval) %&gt;% 
  mutate(model = as.factor(model))
  # mcp{multcomp}では因子型である必要があるため文字列型から変換
df_print(x)</code></pre>
<div id="htmlwidget-b9c80844beaeb1e87e33" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b9c80844beaeb1e87e33">{"x":{"filter":"none","extensions":["Scroller","FixedColumns"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["現行","現行","現行","現行","現行","現行","現行","現行","現行","現行","A案","A案","A案","A案","A案","A案","A案","A案","A案","A案","B案","B案","B案","B案","B案","B案","B案","B案","B案","B案","C案","C案","C案","C案","C案","C案","C案","C案","C案","C案"],[1,2,2,3,3,3,4,3,3,2,3,4,2,3,3,3,5,3,4,3,3,5,4,5,3,3,4,4,4,4,5,3,4,1,3,4,5,5,4,5]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>model<\/th>\n      <th>eval<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"deferRender":true,"dom":"t","scroller":false,"scrollY":250,"fixedColumns":true,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="可視化-1" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = model, y = eval)) + 
  # geom_violin() +
  # geom_boxplot(width = 0.1) +
  geom_boxplot() +
  # geom_jitter(colour = &quot;blue&quot;) +
  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;, dotsize = 0.5,
               fill = &quot;blue&quot;, colour = &quot;blue&quot;) + 
  stat_summary(fun.y = mean, geom = &quot;point&quot;, shape = 18, size = 3,
               color = &quot;red&quot;) +
  xlab(&quot;GUIデザイン&quot;) + ylab(&quot;評価結果(5段階)&quot;)</code></pre>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = eval, fill = model)) +
  geom_histogram(binwidth = 1, alpha = 0.5) + 
  facet_wrap(~ model) +
  xlab(&quot;評価結果(5段階)&quot;) + ylab(&quot;度数&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
<p>現行案に対して、A, B, Cの各案とも評価結果が良くなっていることの見当はつきますが、どの案がベストなのか、本当に良くなっているかは、グラフだけでは断言できません。</p>
</div>
<div id="一元配置分散分析-3" class="section level2">
<h2>一元配置分散分析</h2>
<p>そこで、一元配置分散分析を行うことで、各案の評価に有意な差があるか確認します。</p>
<pre class="r"><code>result.aov &lt;- aov(eval ~ model, data = x)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## model        3  11.48   3.825   4.263 0.0112 *
## Residuals   36  32.30   0.897                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>一元配置分散分析の結果、<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されましたので、因子間に有意な差があることが分かります。</p>
</div>
<div id="多重比較-3" class="section level2">
<h2>多重比較</h2>
<p>そこで、多重比較によりどの因子間に有意差があるのかを確認します。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(model = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = eval ~ model, data = x)
## 
## Linear Hypotheses:
##                   Estimate Std. Error t value Pr(&gt;|t|)  
## B案 - A案 == 0   6.000e-01  4.236e-01   1.416   0.4976  
## C案 - A案 == 0   6.000e-01  4.236e-01   1.416   0.4976  
## 現行 - A案 == 0 -7.000e-01  4.236e-01  -1.652   0.3631  
## C案 - B案 == 0  -1.221e-15  4.236e-01   0.000   1.0000  
## 現行 - B案 == 0 -1.300e+00  4.236e-01  -3.069   0.0203 *
## 現行 - C案 == 0 -1.300e+00  4.236e-01  -3.069   0.0203 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>多重比較の結果、現行のGUIとB案、C案との間で有意な差が認められます。</p>
</div>
<div id="結果の可視化-3" class="section level2">
<h2>結果の可視化</h2>
<p>多重比較の結果である因子間の平均の差の95%信頼区間は以下の通りになります。</p>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(model = as.factor(row.names(.))) %&gt;% 
  select(factor = model, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;GUIデザイン&quot;) + ylab(&quot;5段階評価結果の平均の差&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>ただ、これだけでは、B案とC案のどちらを選べば良いか、数値だけでは判断がつきません。</p>
</div>
<div id="因子毎の平均値の95信頼区間" class="section level2">
<h2>因子毎の平均値の95%信頼区間</h2>
<p>そこで、始めに戻り各因子(GUIデザイン)の評価結果の平均値と95%信頼区間を見てみます。</p>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(model) %&gt;%
  summarize(lo = round(t.test(eval)$conf.int[1], n),
            mu = round(t.test(eval)$estimate, n),
            up = round(t.test(eval)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = model, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;プロトタイプ&quot;) + ylab(&quot;5段階評価値&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>これを見るとC案の評価はB案の評価と比べると評価が散らばっていることが分かります。言い換えるとC案の平均的な評価はB案と同等ですが、人により好き嫌いが別れると言えます。したがって、今回はより万人受けするB案を採用することを推奨することとします。</p>
</div>
</div>
<div id="演習-3.3" class="section level1">
<h1>演習 3.3</h1>
<blockquote>
<p>システム構成の違いとソフトウェア設定のどちらがシステムのパフォーマンスに影響を与えるのかを調べるためにそれぞれ4水準と3水準を用意して全組合せでパフォーマンステストを行い、以下のようなデータを収集しました。 システム構成の違いとソフトウェア設定のどちらがパフォーマンスに与えるといえるでしょうか？ 二元配置分散分析を行ってください。</p>
</blockquote>
<div id="データの設定-4" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="可視化-2" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = system, y = r.time)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) +
  xlab(&quot;システム構成&quot;) + ylab(&quot;レスポンス時間[msec]&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>システム構成に着目すると構成Aと構成Dが優れているように見えます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = software, y = r.time)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) +
  xlab(&quot;ソフトウェア設定&quot;) + ylab(&quot;レスポンス時間[msec]&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>一方、ソフトウェア設定に着目すると設定Xが他の設定に比べると優れているように見えますが、どちらのシステム構成との組み合わせが良いのかはグラフからは判断できません。</p>
</div>
<div id="二元配置分散分析" class="section level2">
<h2>二元配置分散分析</h2>
<p>そこで、二元配置の分散分析を行ってみます。</p>
<pre class="r"><code>result.aov &lt;- aov(r.time ~ system + software, data = x)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)   
## system       3   8700  2900.0   9.943 0.0096 **
## software     2    650   325.0   1.114 0.3877   
## Residuals    6   1750   291.7                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>二元配置分散分析の結果、システム構成に対しては<span class="math inline">\(5\%\)</span>有意で帰無仮説が棄却されていますが、ソフトウェア設定に対しては帰無仮説が棄却されていないことが分かります。</p>
</div>
<div id="多重比較-4" class="section level2">
<h2>多重比較</h2>
<p>そこで、二元配置分散分析の結果、システム構成に対する多重比較を行いどの因子間に有意差があるのかを確認します。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(system = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = r.time ~ system + software, data = x)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)   
## B - A == 0    50.00      13.94   3.586  0.04332 * 
## C - A == 0    30.00      13.94   2.151  0.23862   
## D - A == 0   -20.00      13.94  -1.434  0.52479   
## C - B == 0   -20.00      13.94  -1.434  0.52479   
## D - B == 0   -70.00      13.94  -5.020  0.00951 **
## D - C == 0   -50.00      13.94  -3.586  0.04356 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
<div id="結果の可視化-4" class="section level2">
<h2>結果の可視化</h2>
<p>因子間の平均の差の95%信頼区間は以下の通りとなります。</p>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(system = as.factor(row.names(.))) %&gt;% 
  select(factor = system, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;システム構成&quot;) + ylab(&quot;レスポンスタイムの平均値の差[msec]&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<p>この結果から</p>
<ul>
<li>システム構成Aはシステム構成B,Cに比べてレスポンスタイムの平均値が低い</li>
<li>システム構成Aはシステム構成Dに比べてレスポンスタイムの平均値が高い</li>
<li>システム構成Dはシステム構成A,B,Cに比べてレスポンスタイムの平均値が低い</li>
</ul>
<p>となります。単純にレスポンスタイムの平均値だけで決めるのであればシステム構成Dを選択すればよいことになります。しかし、システム構成AとDの平均値の差の95%信頼区間を確認すると必ずもシステム構成Dのレスポンスタイムが短いとは言い切れません。</p>
</div>
<div id="因子毎の平均値の95信頼区間-1" class="section level2">
<h2>因子毎の平均値の95%信頼区間</h2>
<p>そこで、各システム構成の平均値の95%信頼区間を確認してみます。</p>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(system) %&gt;%
  summarize(lo = round(t.test(r.time)$conf.int[1], n),
            mu = round(t.test(r.time)$estimate, n),
            up = round(t.test(r.time)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = system, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;システム構成&quot;) + ylab(&quot;5段階評価値&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>平均値でみるとシステム構成Dの方がレスポンスタイムが短いですが、95%信頼区間を見るとシステム構成Aの方が狭くレスポンスタイムにばらつきがありません。これより</p>
<ul>
<li>安定したレスポンスタイムが求められる場合はシステム構成A</li>
<li>全体として短いレスポンスタイムが求められる場合はシステム構成D</li>
</ul>
<p>という選択ができると考えます。</p>
</div>
<div id="参考多重比較" class="section level2">
<h2>参考)多重比較</h2>
<p>二元配置分散分析の結果、ソフトウェアに対しては<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されなかったが、多重比較により因子間の差を確認してみます。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(software = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = r.time ~ system + software, data = x)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)
## Y - X == 0    12.50      12.08   1.035    0.584
## Z - X == 0    17.50      12.08   1.449    0.377
## Z - Y == 0     5.00      12.08   0.414    0.911
## (Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(software = as.factor(row.names(.))) %&gt;% 
  select(factor = software, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;ソフトウェア設定&quot;) + ylab(&quot;レスポンスタイムの平均値の差[msec]&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
</div>
<div id="演習-3.4" class="section level1">
<h1>演習 3.4</h1>
<blockquote>
<p>以下に前著『データ指向のソフトウェア品質マネジメント』の3.2節で取り扱っているリリース後の品質問題が「なし」と「あり」の2つの群に分けた各プロジェクトのシステムテストでの欠陥密度のデータを掲載しています。 品質問題の「なし」のほうが「あり」よりも明らかに欠陥密度が小さいことを見出せれば、このメトリクスでリリース後の品質をある程度予見できることになります。 そうすれば、システムテストでの欠陥密度がリリース判定材料の一つとして活用できます。</p>
<p>このデータを使って、まずは分散比のF検定を行って、2つの群の分散が等しいとみなせるかの確認を行い、その結果にもとづいて、2群の母平均の差のt検定を適切なオプション指定で実施してください。</p>
</blockquote>
<div id="データの設定-5" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="可視化-3" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  tidyr::gather(value = defect.density) %&gt;%
  na.omit() %&gt;% 
  ggplot(aes(x = key, y = defect.density)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) +
  xlab(&quot;品質問題の有無&quot;) + ylab(&quot;欠陥密度&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<pre class="r"><code>x %&gt;% 
  tidyr::gather(value = defect.density) %&gt;%
  na.omit() %&gt;% 
  ggplot(aes(x = defect.density, fill = key)) +
  geom_histogram(binwidth = 0.5, alpha = 0.5) + 
  facet_wrap(~ key) +
  xlab(&quot;欠陥密度&quot;) + ylab(&quot;度数&quot;)</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-35-2.png" width="672" /></p>
</div>
<div id="検定" class="section level2">
<h2>検定</h2>
<pre class="r"><code>result.var.test &lt;- var.test(x$no, x$yes)
result.var.test</code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x$no and x$yes
## F = 2.8502, num df = 47, denom df = 14, p-value = 0.03591
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  1.076490 6.152851
## sample estimates:
## ratio of variances 
##           2.850151</code></pre>
<pre class="r"><code>if(result.var.test$p.value &lt; 0.05){
  # 帰無仮説が棄却される(不等分散)
  t.test(x$no, x$yes, alternative = &quot;less&quot;, paired = FALSE,
         var.equal = FALSE)
} else {
  # 帰無仮説が棄却されない(等分散と見なせる)
  t.test(x$no, x$yes, alternative = &quot;less&quot;, paired = FALSE,
         var.equal = TRUE)
}</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  x$no and x$yes
## t = -0.92355, df = 40.48, p-value = 0.1806
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf 0.07096076
## sample estimates:
## mean of x mean of y 
## 0.4404167 0.5266667</code></pre>
</div>
<div id="一元配置分散分析-4" class="section level2">
<h2>一元配置分散分析</h2>
<p>一元配置の分散分析でも行ってみます。</p>
<pre class="r"><code>result.aov &lt;- x %&gt;% 
  tidyr::gather(value = defect.density) %&gt;%
  na.omit() %&gt;% 
  mutate(key = as.factor(key)) %&gt;% 
  aov(defect.density ~ key, data = .)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## key          1  0.085 0.08502   0.507  0.479
## Residuals   61 10.238 0.16783</code></pre>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(key = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = defect.density ~ key, data = .)
## 
## Linear Hypotheses:
##               Estimate Std. Error t value Pr(&gt;|t|)
## yes - no == 0  0.08625    0.12118   0.712    0.479
## (Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(system = as.factor(row.names(.))) %&gt;% 
  select(factor = system, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;品質問題の有無&quot;) + ylab(&quot;欠陥密度&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
</div>
<div id="演習-3.5" class="section level1">
<h1>演習 3.5</h1>
<blockquote>
<p>31プロジェクトの数値データ、カテゴリデータがあります。このデータを使って、カテゴリデータのいずれが、欠陥密度（Defects/KLOC）に強い影響を与えているかを調べてください。 そして、分析結果から欠陥密度を下げるには、どのような改善策が考えられるかを考察してください。</p>
<p>データ説明 各行が１プロジェクトごとのデータとなります。31プロジェクト分のデータが有ります。ただし、全ての項目が入力されている訳ではなく、所々に欠損値が有ります。</p>
</blockquote>
<div id="データの設定-6" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="一元配置分散分析-5" class="section level2">
<h2>一元配置分散分析</h2>
<p>一元配置の分散分析により各因子の有意差を確認します。</p>
<pre class="r"><code>factor &lt;- colnames(x)[5:31]
result.aov &lt;- NULL

for(i in factor){
  result.aov &lt;- x %&gt;% 
    aov(defect.density ~ x[[i]], data = .) %&gt;% 
    anova() %&gt;% 
    as.data.frame() %&gt;% 
    na.omit() %&gt;% 
    mutate(factor = i) %&gt;%
    bind_rows(result.aov, .)
}

result.aov</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["factor"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"4","2":"82.118391","3":"20.529598","4":"0.28567003","5":"0.884361099","6":"S1"},{"1":"3","2":"83.647365","3":"27.882455","4":"0.40450994","5":"0.751034544","6":"S2"},{"1":"3","2":"141.685103","3":"47.228368","4":"0.70905517","5":"0.555688742","6":"S3"},{"1":"3","2":"39.613300","3":"13.204433","4":"0.18679262","5":"0.904379679","6":"S4"},{"1":"3","2":"155.766096","3":"51.922032","4":"0.78617066","5":"0.512942845","6":"S5"},{"1":"4","2":"273.185451","3":"68.296363","4":"1.06874055","5":"0.393624786","6":"S6"},{"1":"4","2":"140.384105","3":"35.096026","4":"0.50543708","5":"0.732115493","6":"S7"},{"1":"3","2":"81.803581","3":"27.267860","4":"0.39517077","5":"0.757574631","6":"F1"},{"1":"4","2":"197.600835","3":"49.400209","4":"0.73673427","5":"0.576065164","6":"F2"},{"1":"2","2":"3.267724","3":"1.633862","4":"0.02355307","5":"0.976742952","6":"F3"},{"1":"4","2":"926.139403","3":"231.534851","4":"6.30933631","5":"0.001286331","6":"D1"},{"1":"4","2":"202.054780","3":"50.513695","4":"0.75543113","5":"0.564349524","6":"D2"},{"1":"3","2":"71.202200","3":"23.734067","4":"0.34185751","5":"0.795251164","6":"D3"},{"1":"2","2":"81.042657","3":"40.521329","4":"0.61046286","5":"0.550701105","6":"D4"},{"1":"2","2":"349.575057","3":"174.787529","4":"3.11842870","5":"0.061103832","6":"T1"},{"1":"5","2":"167.773402","3":"33.554680","4":"0.47084280","5":"0.794022052","6":"T2"},{"1":"3","2":"435.259724","3":"145.086575","4":"2.64445366","5":"0.071179229","6":"T3"},{"1":"2","2":"127.348153","3":"63.674076","4":"0.98571167","5":"0.386691087","6":"T4"},{"1":"2","2":"56.914730","3":"28.457365","4":"0.42280553","5":"0.659630464","6":"P1"},{"1":"2","2":"186.351395","3":"93.175698","4":"1.49493227","5":"0.242914313","6":"P2"},{"1":"3","2":"170.973724","3":"56.991241","4":"0.87094735","5":"0.469248056","6":"P3"},{"1":"4","2":"206.894057","3":"51.723514","4":"0.77586355","5":"0.551732674","6":"P4"},{"1":"2","2":"395.781956","3":"197.890978","4":"3.64623538","5":"0.040193440","6":"P5"},{"1":"2","2":"456.996415","3":"228.498207","4":"4.40111272","5":"0.022581996","6":"P6"},{"1":"3","2":"322.345474","3":"107.448491","4":"1.80947443","5":"0.171243520","6":"P7"},{"1":"2","2":"175.248120","3":"87.624060","4":"1.39629358","5":"0.265463338","6":"P8"},{"1":"2","2":"139.898961","3":"69.949480","4":"1.09101152","5":"0.350764287","6":"P9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>result &lt;- result.aov %&gt;% 
  select(factor, p.value = 5) %&gt;% 
  filter(p.value &lt; 0.05)

result</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["factor"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"D1","2":"0.001286331"},{"1":"P5","2":"0.040193440"},{"1":"P6","2":"0.022581996"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="可視化-4" class="section level2">
<h2>可視化</h2>
<p>p値が0.05未満のデータを可視化してみます。</p>
<pre class="r"><code>for(i in result$factor){
  graph &lt;- x %&gt;%
    ggplot(aes(x = x[[i]], y = defect.density)) +
    geom_boxplot() +
    geom_jitter(colour = &quot;red&quot;) +
    xlab(i) + ylab(&quot;欠陥密度&quot;)
  print(graph)
}</code></pre>
<p><img src="smsa_3_files/figure-html/unnamed-chunk-40-1.png" width="672" /><img src="smsa_3_files/figure-html/unnamed-chunk-40-2.png" width="672" /><img src="smsa_3_files/figure-html/unnamed-chunk-40-3.png" width="672" /></p>
</div>
<div id="参考生産性の場合" class="section level2">
<h2>参考)生産性の場合</h2>
<pre class="r"><code>factor &lt;- colnames(x)[5:31]
result.aov &lt;- NULL

for(i in factor){
  result.aov &lt;- x %&gt;% 
    aov(productivity ~ x[[i]], data = .) %&gt;% 
    anova() %&gt;% 
    as.data.frame() %&gt;% 
    na.omit() %&gt;% 
    mutate(factor = i) %&gt;%
    bind_rows(result.aov, .)
}

result.aov</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["factor"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"4","2":"4.3102843","3":"1.0775711","4":"0.39413579","5":"0.81077940","6":"S1"},{"1":"3","2":"0.8487608","3":"0.2829203","4":"0.10239196","5":"0.95788864","6":"S2"},{"1":"3","2":"3.0644336","3":"1.0214779","4":"0.38193465","5":"0.76687877","6":"S3"},{"1":"3","2":"8.2076057","3":"2.7358686","4":"1.10819703","5":"0.36438885","6":"S4"},{"1":"3","2":"5.6848512","3":"1.8949504","4":"0.73743044","5":"0.53962559","6":"S5"},{"1":"4","2":"18.0513522","3":"4.5128381","4":"2.08786061","5":"0.11385671","6":"S6"},{"1":"4","2":"14.1019672","3":"3.5254918","4":"1.51567372","5":"0.22920744","6":"S7"},{"1":"3","2":"8.2370733","3":"2.7456911","4":"1.11270702","5":"0.36262838","6":"F1"},{"1":"4","2":"14.9990917","3":"3.7497729","4":"1.63842651","5":"0.19720578","6":"F2"},{"1":"2","2":"7.8302050","3":"3.9151025","4":"1.63927070","5":"0.21355554","6":"F3"},{"1":"4","2":"14.0779994","3":"3.5194998","4":"1.51244831","5":"0.23011405","6":"D1"},{"1":"4","2":"8.1677895","3":"2.0419474","4":"0.79351921","5":"0.54099038","6":"D2"},{"1":"3","2":"3.5664901","3":"1.1888300","4":"0.44787129","5":"0.72098469","6":"D3"},{"1":"2","2":"0.6416506","3":"0.3208253","4":"0.12039364","5":"0.88706273","6":"D4"},{"1":"2","2":"3.1727561","3":"1.5863781","4":"0.61788024","5":"0.54681440","6":"T1"},{"1":"5","2":"6.0744728","3":"1.2148946","4":"0.43761441","5":"0.81762451","6":"T2"},{"1":"3","2":"9.3112372","3":"3.1037457","4":"1.28010039","5":"0.30282156","6":"T3"},{"1":"2","2":"3.7037601","3":"1.8518800","4":"0.72707455","5":"0.49288963","6":"T4"},{"1":"2","2":"4.1255521","3":"2.0627760","4":"0.81506672","5":"0.45360178","6":"P1"},{"1":"2","2":"15.5287172","3":"7.7643586","4":"3.71105677","5":"0.03821314","6":"P2"},{"1":"3","2":"4.1940306","3":"1.3980102","4":"0.53170444","5":"0.66471790","6":"P3"},{"1":"4","2":"10.6941039","3":"2.6735260","4":"1.08326877","5":"0.38689603","6":"P4"},{"1":"2","2":"10.7830386","3":"5.3915193","4":"2.37015991","5":"0.11335601","6":"P5"},{"1":"2","2":"2.1225577","3":"1.0612789","4":"0.40695633","5":"0.66983996","6":"P6"},{"1":"3","2":"2.8470714","3":"0.9490238","4":"0.35369396","5":"0.78684584","6":"P7"},{"1":"2","2":"5.5355562","3":"2.7677781","4":"1.11758280","5":"0.34227810","6":"P8"},{"1":"2","2":"0.3343686","3":"0.1671843","4":"0.06246094","5":"0.93959028","6":"P9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>result.aov %&gt;% 
  select(factor, p.value = 5) %&gt;% 
  filter(p.value &lt; 0.05)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["factor"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"P2","2":"0.03821314"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<hr />
<!-- Include Footer -->
<p><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="Sampo Suzuki" target="_blank" title="CC BY-NC-SA 4.0 icon" /> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja" target="_blank" title="CC BY-NC-SA 4.0">CC BY-NC-SA 4.0 <i class="fa fa-external-link"></i></a>, Sampo Suzuki [2018-03-17 15:26(JST)]</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
