<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>第3章 演習解答例</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<script src="site_libs/datatables-binding-0.2/datatables.js"></script>
<link href="site_libs/dt-core-bootstrap-1.10.12/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-bootstrap-1.10.12/css/dataTables.bootstrap.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-bootstrap-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="site_libs/dt-core-bootstrap-1.10.12/js/dataTables.bootstrap.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ソフトウェアメトリクス統計分析入門</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    例題
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./example_1.html">第1章 例題解答例</a>
    </li>
    <li>
      <a href="./example_2.html">第2章 例題解答例</a>
    </li>
    <li>
      <a href="./example_3.html">第3章 例題解答例</a>
    </li>
    <li>
      <a href="./example_4.html">第4章 例題解答例</a>
    </li>
    <li>
      <a href="./example_5.html">第5章 例題解答例</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    演習
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./exercise_1.html">第1章 演習解答例</a>
    </li>
    <li>
      <a href="./exercise_2.html">第2章 演習解答例</a>
    </li>
    <li>
      <a href="./exercise_3.html">第3章 演習解答例</a>
    </li>
    <li>
      <a href="./exercise_4.html">第4章 演習解答例</a>
    </li>
    <li>
      <a href="./exercise_5.html">第5章 演習解答例</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    その他
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./about.html">R環境情報</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Model/Infer
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../index.html">
        <span class="fa fa-home"></span>
         
        Model/Infer Top
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../../stats/index.html">
        <span class="fa fa-bar-chart"></span>
         
        統計
      </a>
    </li>
    <li>
      <a href="../../books/index.html">
        <span class="fa fa-book"></span>
         
        書籍
      </a>
    </li>
    <li>
      <a href="../../gacco/index.html">
        <span class="fa fa-graduation-cap"></span>
         
        gacco
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-github"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../../">
        <span class="fa fa-github"></span>
         
        Cabinet
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../../../import/">　Import</a>
    </li>
    <li>
      <a href="../../../tidy/">　Tidy/Transform</a>
    </li>
    <li>
      <a href="../../index.html">
        <span class="fa fa-home"></span>
         
        Model/Infer
      </a>
    </li>
    <li>
      <a href="../../visualize/">　Visualize</a>
    </li>
    <li>
      <a href="../../communicate/">　Communicate/Automate</a>
    </li>
    <li>
      <a href="../../program/">　Program</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://sites.google.com/site/kantometrics/home">
        <span class="fa fa-google"></span>
         
        データ分析勉強会
      </a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">第3章 演習解答例</h1>

</div>


<!-- Include Common Links -->
<!-- SQiP -->
<!-- Books -->
<!-- Creative Commons -->
<!-- R -->
<!-- RStudio -->
<!-- Cabinet Pages -->
<pre class="r"><code># データハンドリングで利用する外部パッケージの読み込み
require(dplyr)
require(tidyr)
# 表示で利用する外部パッケージの読み込み
require(ggplot2)
require(DT)
require(knitr)</code></pre>
<div id="はじめに" class="section level1">
<h1>はじめに</h1>
<p>本資料は『<a href="http://www.juse-p.co.jp/cgi-bin/html.pl5?i=ISBN978-4-8171-9558-6" title="ソフトウェアメトリクス統計分析入門">ソフトウェアメトリクス統計分析入門</a>』(以降、テキストと記載)の第3章の演習問題を<a href="https://www.r-project.org/" title="The R Project">R</a>で解いた際の解答例を示したものです。また、<a href="http://rmarkdown.rstudio.com/" title="R Markdown form RStudio">R Markdown</a>を使うメリットを示すための一手段として作成していますので、テキストにおける計算方法とは異なる部分もあります。本資料で使用しているデータの入手に関してはテキストにてご確認下さい。<br />
本資料がHTML形式の場合、Rのコードを参照するには右側にある<strong><code>[Code]</code></strong>ボタンをクリックして下さい。なお、JavaScriptは必ずOnにしてご覧下さい。</p>
</div>
<div id="演習-3.1" class="section level1">
<h1>演習 3.1</h1>
<blockquote>
<p>完了したプロジェクトを上流でのレビュー実施度合いが、多い、中ぐらい、少ない、の3 段階に分類しました． そして、それらのプロジェクトの最終システムテスト工程での欠陥密度のデータは以下のとおりです。 上流でしっかりとレビューを実施すれば、システムテストでの欠陥密度は低下することが期待できます。 果たして、その期待どおり上流でのレビューは、下流での品質向上に効果があるといえるでしょうか。</p>
</blockquote>
<div id="データの設定" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="可視化" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = review.freq, y = defect.density)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) + 
  xlab(&quot;レビューの実施度合い&quot;) + ylab(&quot;欠陥密度&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="一元配置分散分析" class="section level2">
<h2>一元配置分散分析</h2>
<p>読み込んだデータは上記のように1変数と因子のですので、そのまま分析を行います。</p>
<pre class="r"><code>result.aov &lt;- aov(defect.density ~ review.freq, data = x)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## review.freq  2  1.093  0.5467   4.217  0.051 .
## Residuals    9  1.167  0.1296                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="多重比較" class="section level2">
<h2>多重比較</h2>
<p>一元配置分散分析の結果、<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されませんでしたが、多重比較により因子間に差を確認してみます。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(review.freq = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = defect.density ~ review.freq, data = x)
## 
## Linear Hypotheses:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## 多 - 少 == 0  -0.7000     0.2415  -2.898   0.0421 *
## 中 - 少 == 0  -0.4333     0.2750  -1.576   0.3035  
## 中 - 多 == 0   0.2667     0.2629   1.014   0.5862  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>多重比較の結果、一元配置分散分析では有意差は認められなかったもののレビュー頻度’多-小’において有意差が認められます。</p>
</div>
<div id="結果の可視化" class="section level2">
<h2>結果の可視化</h2>
<p>因子間の平均の差の95%信頼区間は以下の通りとなります。</p>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(review.freq = as.factor(row.names(.))) %&gt;% 
  select(factor = review.freq, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;レビュー頻度&quot;) + ylab(&quot;レビュー密度の平均値の差&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="結果の解釈" class="section level2">
<h2>結果の解釈</h2>
<p>一元配置分散分析において有意差は認められなかったものの多重比較を行うと有意差が認めれられています。これは、以下のような解釈(定性分析)により有意差は認められないと結論できのではないでしょうか？</p>
<div id="定性分析" class="section level3">
<h3>定性分析</h3>
</div>
</div>
<div id="参考因子毎の平均値の95信頼区間" class="section level2">
<h2>参考)因子毎の平均値の95%信頼区間</h2>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(review.freq) %&gt;%
  summarize(lo = round(t.test(defect.density)$conf.int[1], n),
            mu = round(t.test(defect.density)$estimate, n),
            up = round(t.test(defect.density)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = review.freq, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;レビューの実施度合い&quot;) + ylab(&quot;レビュー密度&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
<div id="演習-3.2" class="section level1">
<h1>演習 3.2</h1>
<blockquote>
<p>システムの機能を改良することになりました。GUI プロトタイプの変更案をA、B、C の3 つ作成しました。 現行も加えて4 つのGUI にて5 段階でユーザビリティ評価を行った結果が以下です。 GUI デザインの違いがユーザビリティに影響を与えているといえるでしょうか？また、どのGUI デザインを採用すべきでしょうか？</p>
</blockquote>
<div id="データの設定-1" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
<pre class="r"><code># 演習のデータを変形せずに読み込み、分析用データフレームに変換する
file &lt;- &quot;./data/ex3_2.csv&quot;
x &lt;- read.csv(file, header = FALSE, row.names = 1, sep = &quot;,&quot;,
              fileEncoding = &quot;CP932&quot;) %&gt;%
  # システム構成の列を行名に設定して転置するのがポイント
  t() %&gt;%
  as.data.frame() %&gt;%
  tidyr::gather(key = model, value = eval) %&gt;% 
  mutate(model = as.factor(model))
  # mcp{multcomp}では因子型である必要があるため文字列型から変換
df_print(x)</code></pre>
<div id="htmlwidget-6a984e9de5c4c4edc00a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6a984e9de5c4c4edc00a">{"x":{"style":"bootstrap","filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"],["現行","現行","現行","現行","現行","現行","現行","現行","現行","現行","A案","A案","A案","A案","A案","A案","A案","A案","A案","A案","B案","B案","B案","B案","B案","B案","B案","B案","B案","B案","C案","C案","C案","C案","C案","C案","C案","C案","C案","C案"],[1,2,2,3,3,3,4,3,3,2,3,4,2,3,3,3,5,3,4,3,3,5,4,5,3,3,4,4,4,4,5,3,4,1,3,4,5,5,4,5]],"container":"<table class=\"table table-striped table-hover table-condensed\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>model<\/th>\n      <th>eval<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="可視化-1" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = model, y = eval)) + 
  # geom_violin() +
  # geom_boxplot(width = 0.1) +
  geom_boxplot() +
  # geom_jitter(colour = &quot;blue&quot;) +
  geom_dotplot(binaxis = &quot;y&quot;, stackdir = &quot;center&quot;, dotsize = 0.5,
               fill = &quot;blue&quot;, colour = &quot;blue&quot;) + 
  stat_summary(fun.y = mean, geom = &quot;point&quot;, shape = 18, size = 3,
               color = &quot;red&quot;) +
  xlab(&quot;GUIデザイン&quot;) + ylab(&quot;評価結果(5段階)&quot;)</code></pre>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = eval, fill = model)) +
  geom_histogram(binwidth = 1, alpha = 0.5) + 
  facet_wrap(~ model) +
  xlab(&quot;評価結果(5段階)&quot;) + ylab(&quot;度数&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<p>現行案に対して、A, B, Cの各案とも評価結果が良くなっていることの見当はつきますが、どの案がベストなのか、本当に良くなっているかは、グラフだけでは断言できません。</p>
</div>
<div id="一元配置分散分析-1" class="section level2">
<h2>一元配置分散分析</h2>
<p>そこで、一元配置分散分析を行うことで、各案の評価に有意な差があるか確認します。</p>
<pre class="r"><code>result.aov &lt;- aov(eval ~ model, data = x)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## model        3  11.48   3.825   4.263 0.0112 *
## Residuals   36  32.30   0.897                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>一元配置分散分析の結果、<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されましたので、因子間に有意な差があることが分かります。</p>
</div>
<div id="多重比較-1" class="section level2">
<h2>多重比較</h2>
<p>そこで、多重比較によりどの因子間に有意差があるのかを確認します。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(model = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = eval ~ model, data = x)
## 
## Linear Hypotheses:
##                   Estimate Std. Error t value Pr(&gt;|t|)  
## B案 - A案 == 0   6.000e-01  4.236e-01   1.416   0.4977  
## C案 - A案 == 0   6.000e-01  4.236e-01   1.416   0.4976  
## 現行 - A案 == 0 -7.000e-01  4.236e-01  -1.652   0.3632  
## C案 - B案 == 0  -1.221e-15  4.236e-01   0.000   1.0000  
## 現行 - B案 == 0 -1.300e+00  4.236e-01  -3.069   0.0203 *
## 現行 - C案 == 0 -1.300e+00  4.236e-01  -3.069   0.0203 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<p>多重比較の結果、現行のGUIとB案、C案との間で有意な差が認められます。</p>
</div>
<div id="結果の可視化-1" class="section level2">
<h2>結果の可視化</h2>
<p>多重比較の結果である因子間の平均の差の95%信頼区間は以下の通りになります。</p>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(model = as.factor(row.names(.))) %&gt;% 
  select(factor = model, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;GUIデザイン&quot;) + ylab(&quot;5段階評価結果の平均の差&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>ただ、これだけでは、B案とC案のどちらを選べば良いか、数値だけでは判断がつきません。</p>
</div>
<div id="因子毎の平均値の95信頼区間" class="section level2">
<h2>因子毎の平均値の95%信頼区間</h2>
<p>そこで、始めに戻り各因子(GUIデザイン)の評価結果の平均値と95%信頼区間を見てみます。</p>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(model) %&gt;%
  summarize(lo = round(t.test(eval)$conf.int[1], n),
            mu = round(t.test(eval)$estimate, n),
            up = round(t.test(eval)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = model, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;プロトタイプ&quot;) + ylab(&quot;5段階評価値&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>これを見るとC案の評価はB案の評価と比べると評価が散らばっていることが分かります。言い換えるとC案の平均的な評価はB案と同等ですが、人により好き嫌いが別れると言えます。したがって、今回はより万人受けするB案を採用することを推奨することとします。</p>
</div>
</div>
<div id="演習-3.3" class="section level1">
<h1>演習 3.3</h1>
<blockquote>
<p>システム構成の違いとソフトウェア設定のどちらがシステムのパフォーマンスに影響を与えるのかを調べるためにそれぞれ4水準と3水準を用意して全組合せでパフォーマンステストを行い、以下のようなデータを収集しました。 システム構成の違いとソフトウェア設定のどちらがパフォーマンスに与えるといえるでしょうか？ 二元配置分散分析を行ってください。</p>
</blockquote>
<div id="データの設定-2" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="可視化-2" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = system, y = r.time)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) +
  xlab(&quot;システム構成&quot;) + ylab(&quot;レスポンス時間[msec]&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>システム構成に着目すると構成Aと構成Dが優れているように見えます。</p>
<pre class="r"><code>x %&gt;% 
  ggplot(aes(x = software, y = r.time)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) +
  xlab(&quot;ソフトウェア設定&quot;) + ylab(&quot;レスポンス時間[msec]&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>一方、ソフトウェア設定に着目すると設定Xが他の設定に比べると優れているように見えますが、どちらのシステム構成との組み合わせが良いのかはグラフからは判断できません。</p>
</div>
<div id="二元配置分散分析" class="section level2">
<h2>二元配置分散分析</h2>
<p>そこで、二元配置の分散分析を行ってみます。</p>
<pre class="r"><code>result.aov &lt;- aov(r.time ~ system + software, data = x)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)   
## system       3   8700  2900.0   9.943 0.0096 **
## software     2    650   325.0   1.114 0.3877   
## Residuals    6   1750   291.7                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>二元配置分散分析の結果、システム構成に対しては<span class="math inline">\(5\%\)</span>有意で帰無仮説が棄却されていますが、ソフトウェア設定に対しては帰無仮説が棄却されていないことが分かります。</p>
</div>
<div id="多重比較-2" class="section level2">
<h2>多重比較</h2>
<p>そこで、二元配置分散分析の結果、システム構成に対する多重比較を行いどの因子間に有意差があるのかを確認します。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(system = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = r.time ~ system + software, data = x)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)   
## B - A == 0    50.00      13.94   3.586  0.04346 * 
## C - A == 0    30.00      13.94   2.151  0.23865   
## D - A == 0   -20.00      13.94  -1.434  0.52484   
## C - B == 0   -20.00      13.94  -1.434  0.52492   
## D - B == 0   -70.00      13.94  -5.020  0.00969 **
## D - C == 0   -50.00      13.94  -3.586  0.04347 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
</div>
<div id="結果の可視化-2" class="section level2">
<h2>結果の可視化</h2>
<p>因子間の平均の差の95%信頼区間は以下の通りとなります。</p>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(system = as.factor(row.names(.))) %&gt;% 
  select(factor = system, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;システム構成&quot;) + ylab(&quot;レスポンスタイムの平均値の差[msec]&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>この結果から</p>
<ul>
<li>システム構成Aはシステム構成B,Cに比べてレスポンスタイムの平均値が低い</li>
<li>システム構成Aはシステム構成Dに比べてレスポンスタイムの平均値が高い</li>
<li>システム構成Dはシステム構成A,B,Cに比べてレスポンスタイムの平均値が低い</li>
</ul>
<p>となります。単純にレスポンスタイムの平均値だけで決めるのであればシステム構成Dを選択すればよいことになります。しかし、システム構成AとDの平均値の差の95%信頼区間を確認すると必ずもシステム構成Dのレスポンスタイムが短いとは言い切れません。</p>
</div>
<div id="因子毎の平均値の95信頼区間-1" class="section level2">
<h2>因子毎の平均値の95%信頼区間</h2>
<p>そこで、各システム構成の平均値の95%信頼区間を確認してみます。</p>
<pre class="r"><code>n &lt;- 2
x.result &lt;- x %&gt;%
  group_by(system) %&gt;%
  summarize(lo = round(t.test(r.time)$conf.int[1], n),
            mu = round(t.test(r.time)$estimate, n),
            up = round(t.test(r.time)$conf.int[2], n),
            num = n())

ggplot(x.result, aes(x = system, y = mu)) +
    geom_point(size = 3) +
    geom_errorbar(aes(ymin = lo, ymax = up), width = 0.1, colour = &quot;blue&quot;) +
    xlab(&quot;システム構成&quot;) + ylab(&quot;5段階評価値&quot;) +
    theme(axis.text = element_text(size = 12)) +
    ggtitle(&quot;因子毎の母平均の95%信頼区間&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>平均値でみるとシステム構成Dの方がレスポンスタイムが短いですが、95%信頼区間を見るとシステム構成Aの方が狭くレスポンスタイムにばらつきがありません。これより</p>
<ul>
<li>安定したレスポンスタイムが求められる場合はシステム構成A</li>
<li>全体として短いレスポンスタイムが求められる場合はシステム構成D</li>
</ul>
<p>という選択ができると考えます。</p>
</div>
<div id="参考多重比較" class="section level2">
<h2>参考)多重比較</h2>
<p>二元配置分散分析の結果、ソフトウェアに対しては<span class="math inline">\(5\%\)</span>有意で帰無仮説は棄却されなかったが、多重比較により因子間の差を確認してみます。</p>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(software = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = r.time ~ system + software, data = x)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)
## Y - X == 0    12.50      12.08   1.035    0.584
## Z - X == 0    17.50      12.08   1.449    0.377
## Z - Y == 0     5.00      12.08   0.414    0.911
## (Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(software = as.factor(row.names(.))) %&gt;% 
  select(factor = software, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;ソフトウェア設定&quot;) + ylab(&quot;レスポンスタイムの平均値の差[msec]&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
</div>
<div id="演習-3.4" class="section level1">
<h1>演習 3.4</h1>
<blockquote>
<p>以下に前著『データ指向のソフトウェア品質マネジメント』の3.2節で取り扱っているリリース後の品質問題が「なし」と「あり」の2つの群に分けた各プロジェクトのシステムテストでの欠陥密度のデータを掲載しています。 品質問題の「なし」のほうが「あり」よりも明らかに欠陥密度が小さいことを見出せれば、このメトリクスでリリース後の品質をある程度予見できることになります。 そうすれば、システムテストでの欠陥密度がリリース判定材料の一つとして活用できます。</p>
<p>このデータを使って、まずは分散比のF検定を行って、2つの群の分散が等しいとみなせるかの確認を行い、その結果にもとづいて、2群の母平均の差のt検定を適切なオプション指定で実施してください。</p>
</blockquote>
<div id="データの設定-3" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="可視化-3" class="section level2">
<h2>可視化</h2>
<p>分析前に対象データを可視化してみます。</p>
<pre class="r"><code>x %&gt;% 
  tidyr::gather(value = defect.density) %&gt;%
  na.omit() %&gt;% 
  ggplot(aes(x = key, y = defect.density)) + 
  geom_boxplot() +
  geom_jitter(colour = &quot;red&quot;) +
  xlab(&quot;品質問題の有無&quot;) + ylab(&quot;欠陥密度&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>x %&gt;% 
  tidyr::gather(value = defect.density) %&gt;%
  na.omit() %&gt;% 
  ggplot(aes(x = defect.density, fill = key)) +
  geom_histogram(binwidth = 0.5, alpha = 0.5) + 
  facet_wrap(~ key) +
  xlab(&quot;欠陥密度&quot;) + ylab(&quot;度数&quot;)</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
</div>
<div id="検定" class="section level2">
<h2>検定</h2>
<pre class="r"><code>result.var.test &lt;- var.test(x$no, x$yes)
result.var.test</code></pre>
<pre><code>## 
##  F test to compare two variances
## 
## data:  x$no and x$yes
## F = 2.8502, num df = 47, denom df = 14, p-value = 0.03591
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  1.076490 6.152851
## sample estimates:
## ratio of variances 
##           2.850151</code></pre>
<pre class="r"><code>if(result.var.test$p.value &lt; 0.05){
  # 帰無仮説が棄却される(不等分散)
  t.test(x$no, x$yes, alternative = &quot;less&quot;, paired = FALSE,
         var.equal = FALSE)
} else {
  # 帰無仮説が棄却されない(等分散と見なせる)
  t.test(x$no, x$yes, alternative = &quot;less&quot;, paired = FALSE,
         var.equal = TRUE)
}</code></pre>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  x$no and x$yes
## t = -0.92355, df = 40.48, p-value = 0.1806
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##        -Inf 0.07096076
## sample estimates:
## mean of x mean of y 
## 0.4404167 0.5266667</code></pre>
</div>
<div id="一元配置分散分析-2" class="section level2">
<h2>一元配置分散分析</h2>
<p>一元配置の分散分析でも行ってみます。</p>
<pre class="r"><code>result.aov &lt;- x %&gt;% 
  tidyr::gather(value = defect.density) %&gt;%
  na.omit() %&gt;% 
  mutate(key = as.factor(key)) %&gt;% 
  aov(defect.density ~ key, data = .)
summary(result.aov)</code></pre>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## key          1  0.085 0.08502   0.507  0.479
## Residuals   61 10.238 0.16783</code></pre>
<pre class="r"><code>result.pairs &lt;- multcomp::glht(result.aov,
                               linfct = multcomp::mcp(key = &quot;Tukey&quot;))
summary(result.pairs)</code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = defect.density ~ key, data = .)
## 
## Linear Hypotheses:
##               Estimate Std. Error t value Pr(&gt;|t|)
## yes - no == 0  0.08625    0.12118   0.712    0.479
## (Adjusted p values reported -- single-step method)</code></pre>
<pre class="r"><code>x.result &lt;- as.data.frame(confint(result.pairs)$confint) %&gt;% 
  mutate(system = as.factor(row.names(.))) %&gt;% 
  select(factor = system, lo = lwr, mu = Estimate, up = upr)

ggplot(x.result, aes(x = factor, y = mu)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = lo, ymax = up), width = 0.05, colour = &quot;blue&quot;) +
  xlab(&quot;品質問題の有無&quot;) + ylab(&quot;欠陥密度&quot;) +
  theme(axis.text = element_text(size = 12)) +
  ggtitle(&quot;95%信頼区間&quot;) + 
  coord_flip()</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
</div>
<div id="演習-3.5" class="section level1">
<h1>演習 3.5</h1>
<blockquote>
<p>31プロジェクトの数値データ、カテゴリデータがあります。このデータを使って、カテゴリデータのいずれが、欠陥密度（Defects/KLOC）に強い影響を与えているかを調べてください。 そして、分析結果から欠陥密度を下げるには、どのような改善策が考えられるかを考察してください。</p>
<p>データ説明 各行が１プロジェクトごとのデータとなります。31プロジェクト分のデータが有ります。ただし、全ての項目が入力されている訳ではなく、所々に欠損値が有ります。</p>
</blockquote>
<div id="データの設定-4" class="section level2">
<h2>データの設定</h2>
<p>本演習で利用するデータは予めCSVファイルとして保存されているものとします。</p>
</div>
<div id="一元配置分散分析-3" class="section level2">
<h2>一元配置分散分析</h2>
<p>一元配置の分散分析により各因子の有意差を確認します。</p>
<pre class="r"><code>factor &lt;- colnames(x)[5:31]
result.aov &lt;- NULL

for(i in factor){
  result.aov &lt;- x %&gt;% 
    aov(defect.density ~ x[[i]], data = .) %&gt;% 
    anova() %&gt;% 
    as.data.frame() %&gt;% 
    na.omit() %&gt;% 
    mutate(factor = i) %&gt;%
    bind_rows(result.aov, .)
}

result.aov</code></pre>
<pre><code>##    Df     Sum Sq    Mean Sq    F value      Pr(&gt;F) factor
## 1   4  82.118391  20.529598 0.28567003 0.884361099     S1
## 2   3  83.647365  27.882455 0.40450994 0.751034544     S2
## 3   3 141.685103  47.228368 0.70905517 0.555688742     S3
## 4   3  39.613300  13.204433 0.18679262 0.904379679     S4
## 5   3 155.766096  51.922032 0.78617066 0.512942845     S5
## 6   4 273.185451  68.296363 1.06874055 0.393624786     S6
## 7   4 140.384105  35.096026 0.50543708 0.732115493     S7
## 8   3  81.803581  27.267860 0.39517077 0.757574631     F1
## 9   4 197.600835  49.400209 0.73673427 0.576065164     F2
## 10  2   3.267724   1.633862 0.02355307 0.976742952     F3
## 11  4 926.139403 231.534851 6.30933631 0.001286331     D1
## 12  4 202.054780  50.513695 0.75543113 0.564349524     D2
## 13  3  71.202200  23.734067 0.34185751 0.795251164     D3
## 14  2  81.042657  40.521329 0.61046286 0.550701105     D4
## 15  2 349.575057 174.787529 3.11842870 0.061103832     T1
## 16  5 167.773402  33.554680 0.47084280 0.794022052     T2
## 17  3 435.259724 145.086575 2.64445366 0.071179229     T3
## 18  2 127.348153  63.674076 0.98571167 0.386691087     T4
## 19  2  56.914730  28.457365 0.42280553 0.659630464     P1
## 20  2 186.351395  93.175698 1.49493227 0.242914313     P2
## 21  3 170.973724  56.991241 0.87094735 0.469248056     P3
## 22  4 206.894057  51.723514 0.77586355 0.551732674     P4
## 23  2 395.781956 197.890978 3.64623538 0.040193440     P5
## 24  2 456.996415 228.498207 4.40111272 0.022581996     P6
## 25  3 322.345474 107.448491 1.80947443 0.171243520     P7
## 26  2 175.248120  87.624060 1.39629358 0.265463338     P8
## 27  2 139.898961  69.949480 1.09101152 0.350764287     P9</code></pre>
<pre class="r"><code>result &lt;- result.aov %&gt;% 
  select(factor, p.value = 5) %&gt;% 
  filter(p.value &lt; 0.05)

result</code></pre>
<pre><code>##   factor     p.value
## 1     D1 0.001286331
## 2     P5 0.040193440
## 3     P6 0.022581996</code></pre>
</div>
<div id="可視化-4" class="section level2">
<h2>可視化</h2>
<p>p値が0.05未満のデータを可視化してみます。</p>
<pre class="r"><code>for(i in result$factor){
  graph &lt;- x %&gt;%
    ggplot(aes(x = x[[i]], y = defect.density)) +
    geom_boxplot() +
    geom_jitter(colour = &quot;red&quot;) +
    xlab(i) + ylab(&quot;欠陥密度&quot;)
  print(graph)
}</code></pre>
<p><img src="exercise_3_files/figure-html/unnamed-chunk-27-1.png" width="672" /><img src="exercise_3_files/figure-html/unnamed-chunk-27-2.png" width="672" /><img src="exercise_3_files/figure-html/unnamed-chunk-27-3.png" width="672" /></p>
</div>
<div id="参考生産性の場合" class="section level2">
<h2>参考)生産性の場合</h2>
<pre class="r"><code>factor &lt;- colnames(x)[5:31]
result.aov &lt;- NULL

for(i in factor){
  result.aov &lt;- x %&gt;% 
    aov(productivity ~ x[[i]], data = .) %&gt;% 
    anova() %&gt;% 
    as.data.frame() %&gt;% 
    na.omit() %&gt;% 
    mutate(factor = i) %&gt;%
    bind_rows(result.aov, .)
}

result.aov</code></pre>
<pre><code>##    Df     Sum Sq   Mean Sq    F value     Pr(&gt;F) factor
## 1   4  4.3102843 1.0775711 0.39413579 0.81077940     S1
## 2   3  0.8487608 0.2829203 0.10239196 0.95788864     S2
## 3   3  3.0644336 1.0214779 0.38193465 0.76687877     S3
## 4   3  8.2076057 2.7358686 1.10819703 0.36438885     S4
## 5   3  5.6848512 1.8949504 0.73743044 0.53962559     S5
## 6   4 18.0513522 4.5128381 2.08786061 0.11385671     S6
## 7   4 14.1019672 3.5254918 1.51567372 0.22920744     S7
## 8   3  8.2370733 2.7456911 1.11270702 0.36262838     F1
## 9   4 14.9990917 3.7497729 1.63842651 0.19720578     F2
## 10  2  7.8302050 3.9151025 1.63927070 0.21355554     F3
## 11  4 14.0779994 3.5194998 1.51244831 0.23011405     D1
## 12  4  8.1677895 2.0419474 0.79351921 0.54099038     D2
## 13  3  3.5664901 1.1888300 0.44787129 0.72098469     D3
## 14  2  0.6416506 0.3208253 0.12039364 0.88706273     D4
## 15  2  3.1727561 1.5863781 0.61788024 0.54681440     T1
## 16  5  6.0744728 1.2148946 0.43761441 0.81762451     T2
## 17  3  9.3112372 3.1037457 1.28010039 0.30282156     T3
## 18  2  3.7037601 1.8518800 0.72707455 0.49288963     T4
## 19  2  4.1255521 2.0627760 0.81506672 0.45360178     P1
## 20  2 15.5287172 7.7643586 3.71105677 0.03821314     P2
## 21  3  4.1940306 1.3980102 0.53170444 0.66471790     P3
## 22  4 10.6941039 2.6735260 1.08326877 0.38689603     P4
## 23  2 10.7830386 5.3915193 2.37015991 0.11335601     P5
## 24  2  2.1225577 1.0612789 0.40695633 0.66983996     P6
## 25  3  2.8470714 0.9490238 0.35369396 0.78684584     P7
## 26  2  5.5355562 2.7677781 1.11758280 0.34227810     P8
## 27  2  0.3343686 0.1671843 0.06246094 0.93959028     P9</code></pre>
<pre class="r"><code>result.aov %&gt;% 
  select(factor, p.value = 5) %&gt;% 
  filter(p.value &lt; 0.05)</code></pre>
<pre><code>##   factor    p.value
## 1     P2 0.03821314</code></pre>
<hr />
<!-- Include Footer -->
<p><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" title="CC BY-NC-SA 4.0 icon" alt="Sampo Suzuki" /> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja" title="CC BY-NC-SA 4.0">CC BY-NC-SA 4.0</a>, Sampo Suzuki [2017-04-22 14:23(JST)]</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
