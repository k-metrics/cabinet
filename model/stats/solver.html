<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>RでSolver</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-1.1/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<script src="site_libs/datatables-binding-0.2/datatables.js"></script>
<link href="site_libs/dt-core-bootstrap-1.10.12/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-bootstrap-1.10.12/css/dataTables.bootstrap.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-bootstrap-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="site_libs/dt-core-bootstrap-1.10.12/js/dataTables.bootstrap.min.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">統計</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tips
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./solver.html">ソルバー</a>
    </li>
    <li class="dropdown-header">分散分析</li>
    <li class="dropdown-header">回帰分析</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Model/Infer
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../index.html">
        <span class="fa fa-home"></span>
         
        Model/Infer Top
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="./index.html">
        <span class="fa fa-bar-chart"></span>
         
        統計
      </a>
    </li>
    <li>
      <a href="../books/index.html">
        <span class="fa fa-book"></span>
         
        書籍
      </a>
    </li>
    <li>
      <a href="../gacco/index.html">
        <span class="fa fa-graduation-cap"></span>
         
        gacco
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-github"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../../">
        <span class="fa fa-github"></span>
         
        Cabinet
      </a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../../import/">　Import</a>
    </li>
    <li>
      <a href="../tidy/">　Tidy/Transform</a>
    </li>
    <li>
      <a href="../index.html">
        <span class="fa fa-home"></span>
         
        Model/Infer
      </a>
    </li>
    <li>
      <a href="../../visualize/">　Visualize</a>
    </li>
    <li>
      <a href="../../communicate/">　Communicate/Automate</a>
    </li>
    <li>
      <a href="../../program/">　Program</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="https://sites.google.com/site/kantometrics/home">
        <span class="fa fa-google"></span>
         
        データ分析勉強会
      </a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">RでSolver</h1>

</div>


<!-- Include Common Links -->
<!-- SQiP -->
<!-- Books -->
<!-- Creative Commons -->
<!-- R -->
<!-- RStudio -->
<!-- Cabinet Pages -->
<div id="はじめに" class="section level1">
<h1>はじめに</h1>
<p>本資料は『<a href="http://gacco.org/" title="gacco, The Japan MOOC">データ指向のソフトウェア品質マネジメント</a>』(以降、テキストと記載)の2015年度第5回の演習問題を<a href="https://www.r-project.org/" title="The R Project">R</a>で解いた際の解答例を示したものです。また、<a href="http://rmarkdown.rstudio.com/" title="R Markdown form RStudio">R Markdown</a>を使うメリットを示すための一手段として作成していますので、テキストにおける計算方法とは異なる部分もあります。本資料で使用しているデータの入手に関してはテキストにてご確認下さい。<br />
本資料がHTML形式の場合、Rのコードを参照するには右側にある<strong><code>[Code]</code></strong>ボタンをクリックして下さい。なお、JavaScriptは必ずOnにしてご覧下さい。</p>
</div>
<div id="正規分布編" class="section level1">
<h1>正規分布編</h1>
<div id="前提条件と事前処理" class="section level2">
<h2>前提条件と事前処理</h2>
<p><a href="https://sites.google.com/site/kantometrics/" title="データ分析勉強会">データ分析勉強会</a>の2015年度第5回の演習データがファイルに保存されているものとします。計算条件は第5回の演習（正規分布編）に準じます。</p>
<pre class="r"><code>Dataset &lt;- read.csv(&quot;./data/solver.csv&quot;, header = TRUE, fileEncoding = &quot;CP932&quot;)
df_print(Dataset)</code></pre>
<div id="htmlwidget-c8dabaa3963015e0d0d9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c8dabaa3963015e0d0d9">{"x":{"style":"bootstrap","filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79"],["Prj1","Prj2","Prj3","Prj4","Prj5","Prj6","Prj7","Prj8","Prj9","Prj10","Prj11","Prj12","Prj13","Prj14","Prj15","Prj16","Prj17","Prj18","Prj19","Prj20","Prj21","Prj22","Prj23","Prj24","Prj25","Prj26","Prj27","Prj28","Prj29","Prj30","Prj31","Prj32","Prj33","Prj34","Prj35","Prj36","Prj37","Prj38","Prj39","Prj40","Prj41","Prj42","Prj43","Prj44","Prj45","Prj46","Prj47","Prj48","Prj49","Prj50","Prj51","Prj52","Prj53","Prj54","Prj55","Prj56","Prj57","Prj58","Prj59","Prj60","Prj61","Prj62","Prj63","Prj64","Prj65","Prj66","Prj67","Prj68","Prj69","Prj70","Prj71","Prj72","Prj73","Prj74","Prj75","Prj76","Prj77","Prj78","Prj79"],[1000,375,3840,14402,1263,8505,2326,10234,3000,2054,10005,1468,7900,2346,1470,626,22785,34062,12888,2349,6200,645,4208,6335,80,10732,19014,6329,443,3735,13603,5162,51876,4935,340,2297,39266,1488,8165,20969,3042,39554,7869,1149,4832,18010,464,9594,2730,9580,2711,11733,17670,1777,8844,2995,417,1221,1662,983,1389,7547,2249,3239,7231,2928,22667,14390,34883,25000,181664,24989,10069,6074,60599,17222,38214,23151,13047],[150,371,873,1162.4,1744,3165,2441,2149,156,2681.9,1074.7,200.7,2403,71,670,123.2,2702,2921.6,429.7,435.5,323,373.5,1253,258,52.5,859.5,4515.3,380.1,297.4,358.5,3197.1,491,4734.8,666,113,366,7372.4,834.1,2615.1,2040.3,191.5,8280,1788,118.7,1360,6135.5,297.6,4058.5,2094.7,1287.9,1502,2137,4288,501.9,1887,889.5,507.8,653.5,593.4,256.3,352.5,1516,532,645,1703,473.7,1247.5,2135.8,7270.6,4521.1,9308,4844.3,1959,1750.5,13800,4900,7191,5841.8,2164],[1,1,3,3,0,0,4,2,1,2,4,4,3,6,0,2,4,1,0,1,1,4,3,0,4,6,1,0,2,5,1,5,4,0,3,2,2,3,5,1,5,4,0,2,2,6,1,4,1,3,0,0,1,2,4,1,0,2,3,1,1,2,5,2,7,2,6,7,13,9,8,11,4,5,7,9,15,8,12],[3,2.574031268,3.584331224,4.158422807,3.101403351,3.929674318,3.36660971,4.010045413,3.477121255,3.312600439,4.000217093,3.166726056,3.897627091,3.370328008,3.167317335,2.796574333,4.357649033,4.532270145,4.110185527,3.370883017,3.792391689,2.809559715,3.624075731,3.801746619,1.903089987,4.030680664,4.27907349,3.801335096,2.646403726,3.572290606,4.133634698,3.712818,4.714966482,3.693287157,2.531478917,3.361160995,4.594016662,3.172602931,3.911956189,4.32157772,3.48315921,4.597190409,3.895919545,3.060320029,3.684126926,4.255513713,2.666517981,3.981999714,3.436162647,3.981365509,3.433129518,4.069409071,4.24723655,3.249687428,3.946648734,3.476396827,2.620136055,3.086715664,3.220631019,2.992553518,3.142702246,3.87777435,3.351989455,3.510410948,3.859198362,3.466571072,4.355394045,4.158060794,4.542613828,4.397940009,5.259268873,4.397748877,4.002986341,3.783474788,4.782465458,4.236083585,4.582222499,4.364569755,4.115510662],[2.176091259,2.56937391,2.941014244,3.065355601,3.241546481,3.500373714,3.387567779,3.332236415,2.193124598,3.42844258,3.031287249,2.302547372,3.380753771,1.851258349,2.826074803,2.090610708,3.431685345,3.465620756,2.633165354,2.638988159,2.509202522,2.572290606,3.097951071,2.411619706,1.720159303,2.934245881,3.65468661,2.57989787,2.473340964,2.55448916,3.50475622,2.691081492,3.675301639,2.823474229,2.053078443,2.563481085,3.86760889,2.921218121,3.417488301,3.30969403,2.282168778,3.918030337,3.252367514,2.074450719,3.133538908,3.78784996,2.473632927,3.60836555,3.321121833,3.109882143,3.176669933,3.329804522,3.632254777,2.700617196,3.2757719,2.949145952,2.705692697,2.815245592,2.773347542,2.408748606,2.547159121,3.180699201,2.725911632,2.809559715,3.231214648,2.675503385,3.096040554,3.329560582,3.861570252,3.655244113,3.968856375,3.68523103,3.292034436,3.243162115,4.139879086,3.69019608,3.856789289,3.766546684,3.335257256],[0,0,0.477121255,0.477121255,-0.301029996,-0.301029996,0.602059991,0.301029996,0,0.301029996,0.602059991,0.602059991,0.477121255,0.77815125,-0.301029996,0.301029996,0.602059991,0,-0.301029996,0,0,0.602059991,0.477121255,-0.301029996,0.602059991,0.77815125,0,-0.301029996,0.301029996,0.698970004,0,0.698970004,0.602059991,-0.301029996,0.477121255,0.301029996,0.301029996,0.477121255,0.698970004,0,0.698970004,0.602059991,-0.301029996,0.301029996,0.301029996,0.77815125,0,0.602059991,0,0.477121255,-0.301029996,-0.301029996,0,0.301029996,0.602059991,0,-0.301029996,0.301029996,0.477121255,0,0,0.301029996,0.698970004,0.301029996,0.84509804,0.301029996,0.77815125,0.84509804,1.113943352,0.954242509,0.903089987,1.041392685,0.602059991,0.698970004,0.84509804,0.954242509,1.176091259,0.903089987,1.079181246],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"]],"container":"<table class=\"table table-striped table-hover table-condensed\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Prj<\/th>\n      <th>CodeSize<\/th>\n      <th>ManHour<\/th>\n      <th>NumRework<\/th>\n      <th>LogCodeSize<\/th>\n      <th>LogManHour<\/th>\n      <th>LogNumRework<\/th>\n      <th>Defect<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># 外部流出の有無で層別して平均値と標準偏差を計算する
LogManHour.mean &lt;- with(Dataset, tapply(LogManHour, Defect, mean, na.rm = TRUE))
LogManHour.sd &lt;- with(Dataset, tapply(LogManHour, Defect, sd, na.rm = TRUE))

# 層別グラフの描画範囲は演習時の通りとする
# 　計算で定めるのであれば標準偏差の3.3倍程度の幅にするとよいかと
LogNumRework.seq &lt;- seq(from = 1.5, to = 5.0, by = 0.05)</code></pre>
</div>
<div id="rでソルバー1変数のソルバー" class="section level2">
<h2>Rでソルバー（1変数のソルバー）</h2>
<pre class="r"><code># 制約条件を計算する関数
f &lt;- function (x, a, b, c, d) {
  abs((1 - pnorm(x, mean = a, sd = b)) - pnorm(x, mean = c, sd = d))
}

# ソルバーの実行（制約条件が最小となる値を計算します）
xmin &lt;- optimize(f, range(LogNumRework.seq), tol = 1e-6,
                 a = LogManHour.mean[&quot;No&quot;], b = LogManHour.sd[&quot;No&quot;],
                 c = LogManHour.mean[&quot;Yes&quot;], d = LogManHour.sd[&quot;Yes&quot;])

# グラフの描画(外部流出なし、青)
plot(LogNumRework.seq,
     dnorm(LogNumRework.seq, mean = LogManHour.mean[&quot;No&quot;], sd = LogManHour.sd[&quot;No&quot;]),
     type = &quot;l&quot;, col = &quot;BLUE&quot;, ylim = c(0, 1.2), ylab = &quot;&quot;, xlab = &quot;&quot;)

# グラフの描画（外部流出あり、赤)
par(new = TRUE)
plot(LogNumRework.seq,
     dnorm(LogNumRework.seq, mean = LogManHour.mean[&quot;Yes&quot;], sd = LogManHour.sd[&quot;Yes&quot;]),
     type = &quot;l&quot;, col = &quot;RED&quot;, ylim = c(0, 1.2), ylab = &quot;&quot;, xlab = &quot;LogNumRework&quot;)
par(new = FALSE)

# 算出された基準値の描画
abline(v = xmin$minimum, col = &quot;GRAY&quot;, lty = 2)</code></pre>
<p><img src="solver_files/figure-html/%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83%E3%81%AE%E3%82%BD%E3%83%AB%E3%83%90%E3%83%BC-1.png" width="672" /></p>
<p>基準値は3.2744372となります。この時の制約条件関数の値は8.7278310^{-8}です。</p>
</div>
</div>
<div id="ポアソン分布編" class="section level1">
<h1>ポアソン分布編</h1>
<div id="前提条件と事前処理-1" class="section level2">
<h2>前提条件と事前処理</h2>
<p><a href="https://sites.google.com/site/kantometrics/" title="データ分析勉強会">データ分析勉強会</a>の2015年度第5回の演習データがデータセットに設定されているものとします。計算条件は第5回の演習（ポアソン分布編）に準じます。</p>
<pre class="r"><code>df_print(Dataset)</code></pre>
<div id="htmlwidget-fcca675570e60fdb6d1e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fcca675570e60fdb6d1e">{"x":{"style":"bootstrap","filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79"],["Prj1","Prj2","Prj3","Prj4","Prj5","Prj6","Prj7","Prj8","Prj9","Prj10","Prj11","Prj12","Prj13","Prj14","Prj15","Prj16","Prj17","Prj18","Prj19","Prj20","Prj21","Prj22","Prj23","Prj24","Prj25","Prj26","Prj27","Prj28","Prj29","Prj30","Prj31","Prj32","Prj33","Prj34","Prj35","Prj36","Prj37","Prj38","Prj39","Prj40","Prj41","Prj42","Prj43","Prj44","Prj45","Prj46","Prj47","Prj48","Prj49","Prj50","Prj51","Prj52","Prj53","Prj54","Prj55","Prj56","Prj57","Prj58","Prj59","Prj60","Prj61","Prj62","Prj63","Prj64","Prj65","Prj66","Prj67","Prj68","Prj69","Prj70","Prj71","Prj72","Prj73","Prj74","Prj75","Prj76","Prj77","Prj78","Prj79"],[1000,375,3840,14402,1263,8505,2326,10234,3000,2054,10005,1468,7900,2346,1470,626,22785,34062,12888,2349,6200,645,4208,6335,80,10732,19014,6329,443,3735,13603,5162,51876,4935,340,2297,39266,1488,8165,20969,3042,39554,7869,1149,4832,18010,464,9594,2730,9580,2711,11733,17670,1777,8844,2995,417,1221,1662,983,1389,7547,2249,3239,7231,2928,22667,14390,34883,25000,181664,24989,10069,6074,60599,17222,38214,23151,13047],[150,371,873,1162.4,1744,3165,2441,2149,156,2681.9,1074.7,200.7,2403,71,670,123.2,2702,2921.6,429.7,435.5,323,373.5,1253,258,52.5,859.5,4515.3,380.1,297.4,358.5,3197.1,491,4734.8,666,113,366,7372.4,834.1,2615.1,2040.3,191.5,8280,1788,118.7,1360,6135.5,297.6,4058.5,2094.7,1287.9,1502,2137,4288,501.9,1887,889.5,507.8,653.5,593.4,256.3,352.5,1516,532,645,1703,473.7,1247.5,2135.8,7270.6,4521.1,9308,4844.3,1959,1750.5,13800,4900,7191,5841.8,2164],[1,1,3,3,0,0,4,2,1,2,4,4,3,6,0,2,4,1,0,1,1,4,3,0,4,6,1,0,2,5,1,5,4,0,3,2,2,3,5,1,5,4,0,2,2,6,1,4,1,3,0,0,1,2,4,1,0,2,3,1,1,2,5,2,7,2,6,7,13,9,8,11,4,5,7,9,15,8,12],[3,2.574031268,3.584331224,4.158422807,3.101403351,3.929674318,3.36660971,4.010045413,3.477121255,3.312600439,4.000217093,3.166726056,3.897627091,3.370328008,3.167317335,2.796574333,4.357649033,4.532270145,4.110185527,3.370883017,3.792391689,2.809559715,3.624075731,3.801746619,1.903089987,4.030680664,4.27907349,3.801335096,2.646403726,3.572290606,4.133634698,3.712818,4.714966482,3.693287157,2.531478917,3.361160995,4.594016662,3.172602931,3.911956189,4.32157772,3.48315921,4.597190409,3.895919545,3.060320029,3.684126926,4.255513713,2.666517981,3.981999714,3.436162647,3.981365509,3.433129518,4.069409071,4.24723655,3.249687428,3.946648734,3.476396827,2.620136055,3.086715664,3.220631019,2.992553518,3.142702246,3.87777435,3.351989455,3.510410948,3.859198362,3.466571072,4.355394045,4.158060794,4.542613828,4.397940009,5.259268873,4.397748877,4.002986341,3.783474788,4.782465458,4.236083585,4.582222499,4.364569755,4.115510662],[2.176091259,2.56937391,2.941014244,3.065355601,3.241546481,3.500373714,3.387567779,3.332236415,2.193124598,3.42844258,3.031287249,2.302547372,3.380753771,1.851258349,2.826074803,2.090610708,3.431685345,3.465620756,2.633165354,2.638988159,2.509202522,2.572290606,3.097951071,2.411619706,1.720159303,2.934245881,3.65468661,2.57989787,2.473340964,2.55448916,3.50475622,2.691081492,3.675301639,2.823474229,2.053078443,2.563481085,3.86760889,2.921218121,3.417488301,3.30969403,2.282168778,3.918030337,3.252367514,2.074450719,3.133538908,3.78784996,2.473632927,3.60836555,3.321121833,3.109882143,3.176669933,3.329804522,3.632254777,2.700617196,3.2757719,2.949145952,2.705692697,2.815245592,2.773347542,2.408748606,2.547159121,3.180699201,2.725911632,2.809559715,3.231214648,2.675503385,3.096040554,3.329560582,3.861570252,3.655244113,3.968856375,3.68523103,3.292034436,3.243162115,4.139879086,3.69019608,3.856789289,3.766546684,3.335257256],[0,0,0.477121255,0.477121255,-0.301029996,-0.301029996,0.602059991,0.301029996,0,0.301029996,0.602059991,0.602059991,0.477121255,0.77815125,-0.301029996,0.301029996,0.602059991,0,-0.301029996,0,0,0.602059991,0.477121255,-0.301029996,0.602059991,0.77815125,0,-0.301029996,0.301029996,0.698970004,0,0.698970004,0.602059991,-0.301029996,0.477121255,0.301029996,0.301029996,0.477121255,0.698970004,0,0.698970004,0.602059991,-0.301029996,0.301029996,0.301029996,0.77815125,0,0.602059991,0,0.477121255,-0.301029996,-0.301029996,0,0.301029996,0.602059991,0,-0.301029996,0.301029996,0.477121255,0,0,0.301029996,0.698970004,0.301029996,0.84509804,0.301029996,0.77815125,0.84509804,1.113943352,0.954242509,0.903089987,1.041392685,0.602059991,0.698970004,0.84509804,0.954242509,1.176091259,0.903089987,1.079181246],["No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","No","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes","Yes"]],"container":"<table class=\"table table-striped table-hover table-condensed\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Prj<\/th>\n      <th>CodeSize<\/th>\n      <th>ManHour<\/th>\n      <th>NumRework<\/th>\n      <th>LogCodeSize<\/th>\n      <th>LogManHour<\/th>\n      <th>LogNumRework<\/th>\n      <th>Defect<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code># 外部流出の有無で層別して平均値を計算する
NumRework.mean &lt;- with(Dataset, tapply(NumRework, Defect, mean, na.rm = TRUE))

# 層別グラフの描画範囲は演習時の通りとする
NumRework.seq &lt;- c(0:20)</code></pre>
</div>
<div id="rでソルバー1変数のソルバー-1" class="section level2">
<h2>Rでソルバー（1変数のソルバー）</h2>
<pre class="r"><code># 制約条件を計算する関数
f &lt;- function (x, a, b) {
  1 - ppois(x, a) + ppois(x, b)
}

# ソルバーの実行（制約条件が最小となる値を計算します）
xmin &lt;- optimize(f, NumRework.seq, tol = 1e-6, maximum = FALSE,
                 a = NumRework.mean[&quot;No&quot;], b = NumRework.mean[&quot;Yes&quot;])

# グラフの描画(外部流出なし、青)
plot(NumRework.seq,
     dpois(NumRework.seq, NumRework.mean[&quot;No&quot;]),
     type = &quot;S&quot;, col = &quot;BLUE&quot;, ylim = c(0, 0.3), ylab = &quot;&quot;, xlab = &quot;&quot;)

# グラフの描画（外部流出あり、赤)
par(new = TRUE)
plot(NumRework.seq,
     dpois(NumRework.seq, NumRework.mean[&quot;Yes&quot;]),
     type = &quot;S&quot;, col = &quot;RED&quot;, ylim = c(0, 0.3), ylab = &quot;&quot;, xlab = &quot;NumRework&quot;)
par(new = FALSE)

# 算出された基準値の描画data
abline(v = round(xmin$minimum, 0), col = &quot;GRAY&quot;, lty = 2)</code></pre>
<p><img src="solver_files/figure-html/%E3%83%9D%E3%82%A2%E3%82%BD%E3%83%B3%E5%88%86%E5%B8%83%E3%81%AE%E3%82%BD%E3%83%AB%E3%83%90%E3%83%BC-1.png" width="672" /></p>
<p>基準値は4となります。この時の制約条件関数の値は0.1745716です。</p>
<hr />
<!-- Include Footer -->
<p><img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" title="CC BY-NC-SA 4.0 icon" alt="Sampo Suzuki" /> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.ja" title="CC BY-NC-SA 4.0">CC BY-NC-SA 4.0</a>, Sampo Suzuki [2017-04-22 14:20(JST)]</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
